(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{460:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Maps=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(o(463));t.Maps=r.default,t.default={name:"maps",type:"package",requiresFusionCharts:!0,extension:function(e){return e.addDep(r.default)}}},461:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=[{initialAttr:function(){return{opacity:0}},finalAttr:function(){return{opacity:1}}}];t.default={"initial.dataset.entities":function(){return{"path.appearing":function(){return r[0].slot="plot",r},"path.updating":function(e){return[{finalAttr:function(){return e.finalAttr}}]},"labelConnectors.appearing":function(){return r[0].slot="final",r},"labelConnectors.updating":null,"entityLabel.appearing":function(){return[{initialAttr:{opacity:0},finalAttr:{opacity:1},slot:"final"}]},"*":null}},"initial.dataset.markers":function(){return{markers:null,"markerItem.appearing":function(){return r[0].slot="final",r},"markerItem.updating":function(e){return[{finalAttr:function(){return e.finalAttr}}]}}},"initial.group.mapGroup":function(){return{"group.appearing":function(e){return[{initialAttr:function(){return Object.assign({opacity:0},e.attr)},finalAttr:function(){return e.attr},slot:"plot"}]},"group.updating":function(e){return[{initialAttr:function(){return Object.assign({opacity:0},e.attr)},finalAttr:function(){return e.attr},slot:"plot"}]},"*":null}}}},462:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=g(o(3)),i=g(o(139)),l=o(5),s=g(o(461)),c=o(0),u=o(4),d=o(9),h=g(o(467));function g(e){return e&&e.__esModule?e:{default:e}}var p=void 0,f=(0,l.getDep)("redraphael","plugin"),m=window.navigator.userAgent,v=/msie/i.test(m)&&!window.opera,b=window.Math,y=b.min,k=b.max,C=/stroke/gi,x=/AppleWebKit/.test(m),w=b.ceil,F=function(e,t){var o=t?(0,c.extend2)(e.FCcolor,t,!1,!0):{FCcolor:e};return o.toString=c.toRaphaelColor,o},_=function(e,t){var o=void 0,r={};if(t=t||1,!e||"object"!=(void 0===e?"undefined":n(e)))return r;for(o in e)C.test(o)||("stroke-width"===o?(r[o]=+e[o]/t,x&&(r[o]=r[o]&&w(r[o])||0)):r[o]=e[o]);return r},L={right:function(){return arguments[1]},left:function(e,t){return e-t},center:function(e,t){return 2*y(t,e-t)}},A={top:function(){return arguments[1]},middle:function(e,t){return 2*y(t,e-t)},bottom:function(e,t){return e-t}};(0,l.addDep)({name:"mapsAnimation",type:"animationRule",extension:s.default}),(0,h.default)(f);var S=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))).components={},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"getName",value:function(){return"entities"}},{key:"getType",value:function(){return"dataset"}},{key:"configureAttributes",value:function(e){if(e){this.JSONData={data:e};var o,r=void 0,n=void 0,a=void 0,i=void 0,l=void 0,s=void 0,u=void 0,d=this,h=d.getFromEnv("chart").jsonData,g=d.config,f=h.map||h.chart,m=[],v=d.getFromEnv("colorManager"),b=h.entitydef||[];for(i in!g.attachEvent&&v&&(d.addExtEventListener("legendUpdate",function(){if("legend"===(u=arguments[1]).component)d.legendInteractivity(u.legendItem,u.colorObj);else for(m=u.maxMinArray,l=m.length,s=0;s<l;s++)d.updateEntityColors(m[s].min,m[s].max)},v),g.attachEvent=!0),r=h.data&&h.data[0]&&h.data[0].data?d.JSONData=h.data[0].data||[]:d.JSONData=h.data||[],g.useSNameAsId=(0,c.pluckNumber)(f.usesnameasid,0),this._redefineEntities(b),o=d.components.data,g.showTooltip=(0,c.pluckNumber)(f.showtooltip,1),g.showHoverEffect=(0,c.pluckNumber)(f.showhovereffect,0),r=function(e){for(var t=void 0,o=e&&e.length||0,r={};o--;)(t=e[o]).id!==p&&(r[t.id.toLowerCase()]=t);return r}(r),d.calculateDataLimits(),h.colorrange||d.detachChild(d.getChildren("colorRange")&&d.getChildren("colorRange")[0].getId()),o)n=r[i],a=o[i],n?this._configureEntity(i,a,(0,c.imprint)(t._sanitizeEntityOptions((0,c.extend2)({},n)),a.config)):this._configureEntity(i,a,a.config)}}},{key:"updateEntityColors",value:function(e,o){var r=void 0,n=void 0,a=void 0,i=void 0,l=void 0,s=this.components.data,c=this.getFromEnv("chart"),u={"fill-opacity":0};for(i in s)a=(n=(r=s[i]).config).cleanValue,l={"fill-opacity":(n.alphaArr||[])[0]/100||1},a<e||a>o?(t.setCustomAttrs(r,u,c),r.hidden=!0):(r.hidden=!1,t.setCustomAttrs(r,l,c))}},{key:"legendInteractivity",value:function(e,o){var r=void 0,n=void 0,a=void 0,i=void 0,l=void 0,s=void 0,c=this,u=c.getFromEnv("chart"),d=c.components.data,h=e.config,g=e.hasState("hidden"),p=c.getFromEnv("colorManager"),f={},m={"fill-opacity":0};for(r in u.getFromEnv("animationManager").setAnimationState("legendInteraction"),d)d.hasOwnProperty(r)&&(a=(h=(n=d[r]).config).cleanValue,s=p.getColorObj(a),i=h.visibleEntityAttr,f["fill-opacity"]=i["fill-opacity"],l=g?f:m,o.code===(!s.outOfRange&&s.code)&&(n.hidden=!g,t.setCustomAttrs(n,l,u),g?e&&e.removeLegendState("hidden"):e.setLegendState("hidden")))}},{key:"calculateDataLimits",value:function(){var e,t=void 0,o=void 0,r=void 0,n=this.getFromEnv("chart"),a=this.config,i=n.jsonData.data||[],l=this.getFromEnv("number-formatter"),s=1/0,c=-1/0;for(r=0,e=i.length;r<e;r++)o=i[r].value,t=l.getCleanValue(o),s=y(s,t),c=k(c,t);a.max=c,a.min=s}},{key:"_configureEntity",value:function(e,t,o){var r,a,i,l,s,d=void 0,h=void 0,g=void 0,f=void 0,m=void 0,v=void 0,b=void 0,y=void 0,k=void 0,C=void 0,x=void 0,w=void 0,_=void 0,L=void 0,A=void 0,S=void 0,E=void 0,O=this,P=O.getFromEnv("chart"),N=O.config,I=this.getFromEnv("number-formatter"),T=P.config.entityOpts,R=t.config,M=t.labelConfig,j=o.value,B=R.cleanValue=I.getCleanValue(j),D=R.formattedValue=B===p?p:I.dataLabels(B),V=(0,c.pluckNumber)(o.showtooltip,T.showTooltip),G=this._getDefaultTooltip(t,o,O),H={formattedValue:D,sName:o.shortLabel,lName:o.label},W=T.dataLabels.style,z=R.toolText=V?(0,c.parseUnsafeString)((0,c.pluck)((0,c.parseTooltext)((0,c.pluck)(o.tooltext,T.tooltext,G),[1,2,7,38,39],H,o))):"",X=R.borderColor=(0,c.pluck)(o.bordercolor,T.borderColor),K=R.borderAlpha=(0,c.pluck)(o.borderalpha,T.borderAlpha),Y=R.borderThickness=(0,c.pluckNumber)(o.borderthickness,T.borderThickness),U=T.hoverOnNull,J=R.useHoverColor=(0,c.pluckNumber)(o.showhovereffect,o.usehovercolor,U?T.showHoverEffect:isNaN(j)?0:T.showHoverEffect),Z=R.labelAlignment,q=O.getFromEnv("colorManager");if(t.hidden=!1,R.showLabel=(0,c.pluckNumber)(o.showlabel,T.showLabels),R.labelPadding=(0,c.pluckNumber)(o.labelpadding,T.labelPadding),R.fontFamily=(0,c.pluck)(o.font,W.fontFamily),R.fontSize=(0,c.pluckNumber)(parseInt(o.fontsize,10),parseInt(W.fontSize,10)),R.fontBold=(0,c.pluckNumber)(o.fontbold,0),R.fontColor=(0,c.pluck)(o.fontcolor,W.color),R.connectorColor=(0,c.pluck)(o.labelconnectorcolor,T.connectorColor),R.connectorAlpha=(0,c.pluck)(o.labelconnectoralpha,T.connectorAlpha),R.hoverBorderThickness=(0,c.pluckNumber)(o.borderhoverthickness,o.hoverborderthickness,T.hoverBorderThickness),R.hoverBorderColor=(0,c.pluck)(o.borderhovercolor,o.hoverbordercolor,T.hoverBorderColor,R.borderColor),R.hoverBorderAlpha=(0,c.pluck)(o.borderhoveralpha,o.hoverborderalpha,T.hoverBorderAlpha,R.borderAlpha),R.connectorThickness=(0,c.pluckNumber)(o.labelconnectorthickness,T.connectorThickness),R.origConnectorThickness=R.connectorThickness,R.borderThickness=Y,R.link=o.link,R.isVisible=!0,R.id=e,R.originalId=o.origId,null!==B&&((d=q&&q.getColor(B))&&!d.outOfRange&&(w=d.code,d.oriAlpha!==p&&(_=d.oriAlpha+""))),(0,c.pluck)(o.color,o.alpha,o.angle,o.ratio)===p?(C=F({color:(0,c.pluck)(w,T.fillColor),alpha:(0,c.pluck)(_,T.fillAlpha),angle:(0,c.pluck)(T.fillAngle),ratio:(0,c.pluck)(T.fillRatio)}),k=F({color:(0,c.pluck)(T.nullEntityColor),alpha:(0,c.pluck)(T.nullEntityAlpha),angle:(0,c.pluck)(T.nullEntityAngle),ratio:(0,c.pluck)(T.nullEntityRatio)}),f=(y=null===B?k:C).FCcolor.color,m=y.FCcolor.alpha,v=y.FCcolor.angle,b=y.FCcolor.ratio):(f=(0,c.pluck)(o.color,w,T.fillColor),m=(0,c.pluck)(o.alpha,_,T.fillAlpha),v=(0,c.pluck)(o.angle,T.fillAngle),b=(0,c.pluck)(o.ratio,T.fillRatio),y=F({color:f,alpha:m,angle:v,ratio:b})),""===z&&(N.showTooltip=0),R.visibleEntityAttr={stroke:(0,u.convertColor)(X,K),fill:(R.fillColor=y).toString(),"fill-opacity":m/100},s=m.split(","),R.alphaArr=s,J&&((0,c.pluck)(o.fillhovercolor,o.fillhoveralpha,o.fillhoverangle,o.fillhoverratio,o.hoverfillcolor,o.hoverfillalpha,o.hoverfillratio,o.hoverfillangle)===p?(!T.hoverColorObject&&(T.hoverColorObject=F({color:T.hoverFillColor,alpha:T.hoverFillAlpha,angle:T.hoverFillAngle,ratio:T.hoverFillRatio})),x=T.hoverColorObject):(f=(0,c.pluck)(o.fillhovercolor,o.hoverfillcolor,T.hoverFillColor),m=(0,c.pluck)(o.fillhoveralpha,o.hoverfillalpha,T.hoverFillAlpha),v=(0,c.pluck)(o.fillhoverangle,o.hoverfillangle,T.hoverFillAngle),b=(0,c.pluck)(o.fillhoverratio,o.hoverfillratio,T.hoverFillRatio),x=F({color:f,alpha:m,angle:v,ratio:b})),R.hoverColor=x),M||(M=t.labelConfig={}),a=R.fontColor,i=R.fontFamily,l=R.fontBold,z=R.toolText,r=R.link,Z?(h=Z[0],g=Z[1]):(h="center",g="middle"),M.align=h,M.vAlign=g,M.bgColor="",M.borderColor="",M.fontColor=a,M.fontFamily=i,M.fontBold=l,M.toolText=z,M.link=r,"object"==n(R.options))for(L=R.entityLabels=R.entityLabels||[],E=(S=R.labels||[]).length;E--;)L[E]||(L[E]={config:{}}),M=L[E].config,(Z=S[E].labelAlignment)?(h=Z[0],g=Z[1]):(h="center",g="middle"),M.align=h,M.vAlign=g,M.displayValue=O.getDisplayValue(t,S[E],R.options.isDataEnabled,!E,o),M.bgColor="",M.borderColor="",M.toolText=z,M.align=h,M.vAlign=g,M.bgColor="",M.borderColor="",M.fontColor=a,M.fontFamily=i,M.fontBold=l,M.toolText=z;else A={shortText:R.shortLabel,text:R.label},M.displayValue=O.getDisplayValue(t,A,!0,!0,o)}},{key:"getDisplayValue",value:function(e,t,o,r,n){var a=void 0,i=this.getFromEnv("chart").config.entityOpts,l=e.config,s=l.cleanValue,u=l.formattedValue,d=i.labelSepChar;return o?r&&void 0!==n.displayvalue?a=n.displayvalue:(a=(0,c.pluck)(i.includeNameInLabels?i.useShortName?t.shortText:t.text:""),i.includeValueInLabels&&null!==s&&(a=a===p?u:a+d+u)):a=l.label,a}},{key:"_redefineEntities",value:function(e){var t=void 0,o=void 0,r=void 0,n=void 0,a=void 0,i=void 0,l=void 0,s=void 0,u=void 0,d=void 0,h=void 0,g=void 0,p=this,f=p.config,m={},v={},b=p.getFromEnv("chart").config.entities,y=f.useSNameAsId,k=0;for(t=e.length;t--;)if(r=(o=e[t]).internalid,n=o.newid?o.newid:r,a=o.sname,i=o.lname,g=b[r],r=(0,c.trimString)(r),n=(n=(0,c.trimString)(n))&&n.toLowerCase(),g){for(h in m[n]=s={origId:r},v[r]=!0,g)s[h]=g[h];s.shortLabel=a||g.shortLabel,s.label=i||g.label,s.showhovereffect=o.showhovereffect,s.fillhovercolor=o.fillhovercolor,s.fillhoveralpha=o.fillhoveralpha,s.fillhoverangle=o.fillhoverangle,s.fillhoverratio=o.fillhoverratio,s.borderhoverthickness=o.borderhoverthickness}for(l in(d=p.components.data)||(d=p.components.data={}),m)d[l=l.toLowerCase()]||(d[l]={config:{}}),d[l].config=m[l],k+=1;for(l in u=d,b)if(s=b[l],!v[l=(0,c.trimString)(l)]){for(h in y?(!(g=u[s.shortLabel.toLowerCase()])&&(g=u[s.shortLabel.toLowerCase()]={}),g.config={},g.origId=s.shortLabel):(!(g=u[l.toLowerCase()])&&(g=u[l.toLowerCase()]={}),g.config={},g.config.origId=l),s)g.config[h]=s[h];k+=1}f.entityCount=k}},{key:"draw",value:function(){var e=this.config,t=this.getFromEnv("chart"),o=c.hasSVG?200:10;this.config.ready=!1,e.BATCH_SIZE=o,e.labelBatchSize=c.hasSVG?200:20,this._batchRender()(0),t.config.entityFlag=!0,t.checkComplete()}},{key:"_batchRender",value:function(){var e=void 0,t=void 0,o=void 0,r=void 0,n=void 0,a=this,i=a.config,l=a.getFromEnv("chart").config.entities.firstEntity,s=a.components.data,c=i.BATCH_SIZE,u=i.entityKeys=l?a._getKeys(l,s):Object.keys(s),h=i.entityLength=u.length;return function i(l){for(e=l,o=0;u[e]!==p;)if(t=s[u[e]],n=a.drawEntity(t,c),o+=n,t.config.drawn&&((r=e===h-1?t:s[u[e-1]])&&(r.config.drawn=!1,r.config.outlineStartIndex=p),e++),o>=c){a.addJob("entityDraw",i.bind(this,e),d.priorityList.entitydraw);break}e===h&&(a._addEventListenersToEntities(0),a.initComplete())}}},{key:"_addEventListenersToEntities",value:function(e){var t=void 0,o=void 0,r=void 0,n=this,a=n.components.data,i=n.config,l=i.BATCH_SIZE,s=i.entityKeys,c=i.entityLength,u=0;for(t=e;t<c;t++)if((r=(o=a[s[t]]).config.options)&&!1===r.isDataEnabled||n.addMouseGestures(o),++u===l){n.addJob("_addEventListenersToEntities",n._addEventListenersToEntities.bind(this,t),d.priorityList.entitydraw);break}}},{key:"_getDefaultTooltip",value:function(e,t){var o=void 0,r=void 0,a=e.config.cleanValue,i=e.config.formattedValue,l=this.getFromEnv("chart").config.entityOpts;if("object"==n(e.config.options)){if(!(r=t.labels&&t.labels[0]))return p;o=(l.useSNameInTooltip?r.shortText:r.text)+(null===a?"":l.tooltipSepChar+i)}else o=(l.useSNameInTooltip?t.shortLabel:t.label)+(null===a?"":l.tooltipSepChar+i);return o}},{key:"drawEntity",value:function(e,t){var o,r,a=void 0,i=void 0,l=void 0,s=void 0,u=void 0,d=void 0,h=this,g=h.getFromEnv("chart"),f=g.getFromEnv("animationManager"),m=e.config,b=c.hasSVG||!v?"litepath":"path",y=g.config.entityOpts,k=m.outlines,C=h.getFromEnv("toolTipController"),x=this.getLinkedParent().getChildContainer("plot"),w=this.getLinkedParent().getChildContainer("plotShadow"),F=m.toolText,L=y.shadow,A=[],S={};if(h._configureEntityDrawingParams(e),i=(m=e.config).visibleEntityAttr,r=m.shadowOptions,a=m.outlineStartIndex===p?k.length:m.outlineStartIndex,e.graphics||(e.graphics={}),d=0,A=m.outlinePath||(m.outlinePath=[]),o=m.customStrokeWidthModifier,"object"==n(m.options)){for(;a--;)if(A=k[a].outline,l=!0===m.options.isDataEnabled?i:(0,c.extend2)((0,c.extend2)({},i),_(k[a].style,o)),(s=e.graphics.outlines)||(s=e.graphics.outlines=[]),s[a]||(s[a]={}),u=s[a].outline,l[b]=A,(u=s[a].outline=f.setAnimation({el:b,container:x,attr:l,component:h,label:"path"})).shadow(!!L&&r,w),C.enableToolTip(u,F),d++,m.outlineStartIndex=a,d===t)return d;return m.drawn=!0,d}for(;a--;)if(A=k[a].concat(A),d++,m.outlineStartIndex=a,d===t)return m.outlinePath=A,d;return e.graphics.outlines||(i[b]=A),Object.assign(S,i,e.hidden&&{"fill-opacity":0}||{}),e.graphics.outlines=f.setAnimation({el:e.graphics.outlines||b,container:x,attr:S,component:h,label:"path"}),m.drawn=!0,m.outlineStartIndex=0,m.outlinePath=[],e.graphics.outlines.shadow(!!L&&r,w),C.enableToolTip(e.graphics.outlines,F),d}},{key:"_configureEntityDrawingParams",value:function(e){var t=void 0,o=this.getFromEnv("chart"),r=e.config,n=o.config.entityOpts,a=o.config.scalingParams,i=!v||c.hasSVG,l=a.scaleFactor,s=a.strokeWidth,u=(i?o.baseScaleFactor:1)*s,d=1===n.scaleBorder,h=r.borderThickness,g=r.alphaArr,p=r.origConnectorThickness,f=r.hoverBorderThickness,m=r.visibleEntityAttr,y=m["fill-opacity"];r.shadowOptions={scalefactor:[l,l*o.config.baseScaleFactor],opacity:k.apply(b,g)/100,useFilter:0},r.fillOpacity=e.hidden?0:y,i?(h=r.entityBorderThickness=d?h*u:h/l,p/=l,t=d?l:a.sFactor,f&&(f=r.hoverBorderThickness=d?f*u:f/l)):(h=d?h*s:h,t=d?a.scaleFactor:o.baseScaleFactor),r.entityBorderThickness=h,r.connectorThickness=p,r.customStrokeWidthModifier=t,m["stroke-width"]=h,m.transform=c.hasSVG||!v?"":a.transformStr}},{key:"drawLabels",value:function(e){var t=void 0,o=void 0,r=void 0,n=void 0,a=this,l=e,s=a.getFromEnv("chart"),c=a.config,u=c.labelBatchSize,d=c.entityLength,h=[],g=0,p=s.getChildren("mapLabelAnnotations")&&s.getChildren("mapLabelAnnotations")[g],f=0,m=0,v=s.getFromEnv("toolTipController"),b=s.config.annotationConfig;for(t in p||(n=new i.default,s.attachChild(n,"mapLabelAnnotations"),p=s.getChildren("mapLabelAnnotations")[g]),p.clear(),p._renderer&&(p._renderer=null),b.showbelow=0,l){if(a.drawLabel(l[t],h),++f===u){for(p.annotation.injectDependency("paper",s.getFromEnv("paper")),p.annotation.injectDependency("toolTipController",v),o=0;o<h.length;o++)h[o].animationLabel="entityLabel";for(r=p.addGroup(Object.assign(b,{id:"entityLabels"+g,items:h,animationLabel:"entityLabelGroup"}),a),s.config.labelsOnTop&&r.store.element.toFront(),o=0;o<r.items.length;o++)r.items[o].addEventListener("mouseover",h[o].onmouseover),r.items[o].addEventListener("mouseout",h[o].onmouseout),r.items[o].addEventListener("click",h[o].onclick);g++,(p=s.getChildren("mapLabelAnnotations")&&s.getChildren("mapLabelAnnotations")[g])||(n=new i.default,s.attachChild(n,"mapLabelAnnotations"),p=s.getChildren("mapLabelAnnotations")[g]),p.clear(),p._renderer&&(p._renderer=null),f=0,h=[]}else if(m==d-1){for(p.annotation.injectDependency("paper",s.getFromEnv("paper")),p.annotation.injectDependency("toolTipController",v),o=0;o<h.length;o++)h[o].animationLabel="entityLabel";for(r=p.addGroup(Object.assign(b,{id:"entityLabels"+g,items:h,animationLabel:"entityLabelGroup"}),a),s.config.labelsOnTop&&r.store.element.toFront(),o=0;o<r.items.length;o++)r.items[o].addEventListener("mouseover",h[o].onmouseover),r.items[o].addEventListener("mouseout",h[o].onmouseout),r.items[o].addEventListener("click",h[o].onclick)}m++}a.drawLabelConnFn(0)}},{key:"drawLabelConnFn",value:function(e){var t=void 0,o=void 0,r=void 0,a=void 0,i=void 0,l=this,s=l.config,c=l.components.data,u=s.BATCH_SIZE,h=s.entityKeys,g=h.length,p=0;for(o=e;o<g;o++){if(a=(i=c[h[o]]).config,"object"==n(a.options))for(t=(r=a.labels)&&r.length||0;t--;)r[t].labelConnectors&&(l.drawLabelConnectors(i,r[t].labelConnectors,l),p++);else a.labelConnectors&&(l.drawLabelConnectors(i,a.labelConnectors,l),p++);if(p===u){l.addJob("drawLabelConnectors",l.drawLabelConnFn.bind(this,o),d.priorityList.entitydraw);break}}}},{key:"_getLabelObject",value:function(e,t,o){var r=void 0,n=void 0,a=void 0,i=void 0,l=void 0,s=void 0,c=void 0,u=void 0,d=void 0,h=void 0,g=void 0,f=this,m=f.getFromEnv("chart"),v=e.config,b=m.config.scalingParams,y=e.graphics&&e.graphics.outlines,k=v.fontSize,C=v.labelPadding,x=v.labels||[],w=v.entityLabels||[];return t===p?(r=e.labelConfig,n=v.labelPosition,a=v.labelAlignment):(g=x[t],i=(r=w[t].config).style=g.style,n=g.labelPosition,a=g.labelAlignment),n?(l=n[0],s=n[1]):(l=(c=y.getBBox()).x+c.width/2,s=c.y+c.height/2),a?(u=a[0],d=a[1],"right"===u?l-=C:"left"===u&&(l+=C),"top"===d?s-=C:"bottom"===d&&(s+=C)):(u="center",d="middle"),h=parseFloat(k)/b.sFactor,!o&&i&&(i.color&&(r.fontColor=i.color),i["font-size"]&&(h=parseFloat(i["font-size"])/b.sFactor),i["font-family"]&&(r.fontFamily=i["font-family"]),i["font-weight"]!==p&&(r.fontBold="bold"===i["font-weight"])),r.x=l.toString(),r.y=s.toString(),r.wrap=1,r.type="text",r.fontSize=h,{x:l.toString(),y:s.toString(),wrapwidth:L[u](void 0,l+void 0)-C,wrapheight:A[d](void 0,s+void 0)-C,wrap:1,type:"text",align:r.align,valign:r.vAlign,text:r.displayValue,tooltext:r.toolText,css:r.link!==p&&{cursor:"pointer",_cursor:"hand"},bgcolor:r.bgColor,bordercolor:r.borderColor,fillcolor:r.fontColor,fontsize:r.fontSize,font:r.fontFamily,bold:r.fontBold,onclick:function(t){var o=void 0,r=void 0,n=e.graphics.outlines;if(n instanceof Array)for(o=0,r=n.length;o<r;o++)f.entityClick(n[o].outline,t);else f.entityClick(n,t)},onmouseover:function(t){var o=void 0,r=void 0,n=e.graphics.outlines;if(n instanceof Array)for(o=0,r=n.length;o<r;o++)f.entityRollOver(n[o].outline,t);else f.entityRollOver(n,t)},onmouseout:function(t){var o=void 0,r=void 0,n=e.graphics.outlines;if(n instanceof Array)for(o=0,r=n.length;o<r;o++)f.entityRollOut(n[o].outline,t);else f.entityRollOut(n,t)},ontouchstart:function(t){var o=void 0,r=void 0,n=e.graphics.outlines;if(n instanceof Array)for(o=0,r=n.length;o<r;o++)f.entityRollOver(n[o].outline,t);else f.entityRollOver(n,t);f.entityRollOver(n,t)}}}},{key:"drawLabel",value:function(e,t){var o=void 0,r=void 0,a=void 0,i=e.config;if(i.showLabel)if("object"==n(i.options))for(r=(a=i.labels)&&a.length||0,o=i.options.isDataEnabled;r--;)t.push(this._getLabelObject(e,r,o,!r));else t.push(this._getLabelObject(e,p,!0,!0))}},{key:"drawLabelConnectors",value:function(e,t,o){for(var r=void 0,n=void 0,a=e.config,i=this.getFromEnv("chart"),l=i.getFromEnv("animationManager"),s=i.config.scalingParams,d=o.getLinkedParent().getChildContainer("plot"),h=t&&t.length||0,g=a.showLabel;h--;)n=t[h],r=e.graphics.connectorElem,g?e.graphics.connectorElem=r=l.setAnimation({el:e.graphics.connectorElem||"path",attr:{path:n,opacity:1,transform:c.hasSVG||!v?"":s.transformStr,stroke:(0,u.convertColor)(a.connectorColor,a.connectorAlpha),"shape-rendering":"crisp","stroke-width":a.connectorThickness},container:d,component:this,label:"labelConnectors"}):r&&r.hide()}},{key:"entityClick",value:function(e,t){var o=e.node.__entity,r=this.getFromEnv("chart"),n=r.config.scalingParams,a=o.graphics.outlines.getBBox(),i=r.getFromEnv("linkClickFN"),l=o.config,s=l.link;a.width*=n.scaleFactor,a.height*=n.scaleFactor,a.x=a.x*n.scaleFactor+n.translateX,a.y=a.y*n.scaleFactor+n.translateY,a.x2=a.x+a.width,a.y2=a.y+a.height,r.fireChartInstanceEvent("entityclick",l.eventArgs,t),s!==p&&i.call({link:s,entity:o,entityBox:a},!0)}},{key:"entityRollOver",value:function(e,t){var o=e.node.__entity,r=o.config,n=this.getFromEnv("chart"),a=n.getFromEnv("animationManager"),i=r.hoverAttr;n.plotEventHandler(e,t,"entityRollOver"),e.data("hovered")?clearTimeout(o.config.timer):r.useHoverColor&&r.isVisible&&!o.hidden&&i&&(n.config.hoverEntity=e,a.setAnimation({el:e,attr:i,component:this,state:"updating",label:"path"}),e.data("hovered",!0))}},{key:"entityRollOut",value:function(e,t){var o=e.node.__entity,r=this,n=r.getFromEnv("chart"),a=n.getFromEnv("animationManager"),i=o.config.revertAttr;n.plotEventHandler(e,t,"entityRollOut"),o.config.timer=setTimeout(function(){!0!==o.hidden&&i&&(a.setAnimation({el:e,attr:i,component:r,state:"updating",label:"path"}),e.data("hovered",!1))},100)}},{key:"addMouseGestures",value:function(e){var t=void 0,o=void 0,r=void 0,n=void 0,a=e.config,i=a.originalId,l=this,s=e.graphics,d=a.useHoverColor,h=a.hoverBorderThickness,g=a.hoverBorderColor,f=a.hoverBorderAlpha,m=a.entityBorderThickness,v=a.borderColor,b=a.borderAlpha,y=a.link,k=a.visibleEntityAttr,C=function(t){y!==p&&t.css({cursor:"pointer",_cursor:"hand"}),t.data("eventArgs",a.eventArgs),t.data("groupId","groupId"+i),t.node.__entity=e,e._listenersBinded||t.click(l.entityClick.bind(l,t)).hover(l.entityRollOver.bind(l,t),l.entityRollOut.bind(l,t))};for(t in a.eventArgs={value:a.cleanValue,label:a.label,shortLabel:a.shortLabel,originalId:a.origId,id:a.id||a.origId},a.legacyEventArgs={value:a.value,lName:a.label,sName:a.shortLabel,id:a.originalId||a.id},d&&(a.hoverAttr={fill:(0,c.toRaphaelColor)(a.hoverColor)},a.revertAttr={fill:(0,c.toRaphaelColor)(a.fillColor),stroke:(0,c.toRaphaelColor)(a.borderColor,a.borderAlpha)},a.revertAttr["fill-opacity"]=k["fill-opacity"],h!==m&&(a.hoverAttr["stroke-width"]=(0,c.pluckNumber)(h,m),a.revertAttr["stroke-width"]=m),(g!==v||f!==b)&&(a.hoverAttr.stroke=(0,u.convertColor)(g,f),a.revertAttr.stroke=(0,u.convertColor)(v,b))),s)if(s.hasOwnProperty(t))if(s[t]instanceof Array){for(o=0,r=(n=s[t]).length;o<r;o++)C(n[o].outline);e._listenersBinded=!0}else C(s[t]),e._listenersBinded=!0}},{key:"getDataLimits",value:function(){var e=this.config;return{max:e.max,min:e.min}}},{key:"initComplete",value:function(){var e=this.getFromEnv("chart"),t=this.components.data;this.drawLabels(t),e.config.entitiesReady=!0,e.checkComplete()}}],[{key:"setCustomAttrs",value:function(e,t){e&&e.graphics.outlines.attr(t)}},{key:"_sanitizeEntityOptions",value:function(e){return delete e.outlines,delete e.label,delete e.shortlabel,delete e.labelposition,delete e.labelalignment,delete e.labelconnectors,e}},{key:"_getKeys",value:function(e,t){for(var o=[e],r=e;t[r];)r=t[r].nextId,o.push(r);return o}}]),t}();t.default=S},463:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),n=function e(t,o,r){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,o);if(void 0===n){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,o,r)}if("value"in n)return n.value;var i=n.get;return void 0!==i?i.call(r):void 0},a=b(o(464)),i=b(o(3)),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(o(142)),s=b(o(10)),c=o(8),u=o(0),d=o(4),h=b(o(139)),g=b(o(37)),p=b(o(466)),f=b(o(141)),m=b(o(471)),v=b(o(476));function b(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var x=(0,g.default)({foregroundcolor:"333333",foregroundalpha:"100",foregrounddarkcolor:"111111",foregrounddarkalpha:"100",foregroundlightcolor:"666666",foregroundlightalpha:"100",backgroundlightcolor:"FFFFFF",backgroundlightalpha:"100",backgroundlightangle:90,backgroundlightratio:"",backgroundcolor:"FFFFCC",backgroundalpha:"100",backgrounddarkcolor:"ffcc66",backgrounddarkalpha:"100",backgrounddarkangle:270,backgrounddarkratio:"",shadow:1},l),w="0,100",F={basefontcolor:"foregroundcolor",bordercolor:"foregrounddarkcolor",borderalpha:"foregrounddarkalpha",bgcolor:"backgroundlightcolor",bgalpha:"backgroundlightalpha",bgangle:"backgroundlightangle",bgratio:"backgroundlightratio",canvasbordercolor:"foregrounddarkcolor",canvasborderalpha:"foregrounddarkalpha",canvasbgcolor:"backgroundlightcolor",canvasbgalpha:"backgroundlightalpha",canvasbgangle:"backgroundlightangle",canvasbgratio:"backgroundlightratio",tooltipbordercolor:"foregrounddarkcolor",tooltipborderalpha:"foregrounddarkalpha",tooltipbgcolor:"backgroundlightcolor",tooltipbgalpha:"backgroundlightalpha",tooltipfontcolor:"foregroundcolor",legendbordercolor:"foregrounddarkcolor",legendborderalpha:"foregrounddarkalpha",markerbordercolor:"foregroundlightcolor",markerborderalpha:"foregroundlightalpha",markerfillcolor:"backgrounddarkcolor",markerfillalpha:"backgrounddarkalpha",markerfillangle:"backgrounddarkangle",markerfillratio:"backgrounddarkratio",plotfillcolor:"backgroundcolor",plotfillalpha:"backgroundalpha",plotfillangle:"backgroundangle",plotfillratio:"backgroundratio",plothoverfillcolor:"backgrounddarkcolor",plothoverfillalpha:"backgrounddarkalpha",plothoverfillangle:"backgrounddarkangle",plothoverfillratio:"backgrounddarkratio",plotbordercolor:"foregroundcolor",plotborderalpha:"foregroundalpha",shadow:"shadow"},_={getMapName:function(){return this.jsVars.instanceAPI.getName().toLowerCase()},getEntityList:function(){var e=void 0,t=void 0,o=void 0,r=void 0,n=void 0,a=this.jsVars.instanceAPI.getDatasets()||[],i=a.length,l=[];for(e=0;e<i;e++)if("entities"===(o=a[e]||[]).getName()){t=o;break}for(e in i=(r=t.components.data).length,r)r.hasOwnProperty(e)&&(n=(r[e]||{}).config||{},l.push({id:n.id,originalId:n.originalId||n.id,label:n.label,shortlabel:n.shortLabel,value:n.value,formattedValue:n.formattedValue,toolText:n.toolText}));return l},getMapAttribute:function(){return(0,c.raiseWarning)(this,"12061210581","run","JavaScriptRenderer~getMapAttribute()",'Use of deprecated "getMapAttribute()". Replace with "getChartAttribute()".'),this.getChartAttribute.apply(this,arguments)},exportMap:function(){var e=this;return(0,c.raiseWarning)(this,"12061210581","run","JavaScriptRenderer~exportMap()",'Use of deprecated "exportMap()". Replace with "exportChart()".'),e.exportChart&&e.exportChart.apply(e,arguments)},addMarker:function(e){var t=void 0,o=void 0,r=void 0,n=this.jsVars.instanceAPI.getDatasets()||[],a=n.length;for(t=0;t<a;t++)if("markers"===(o=n[t]||[]).getName()){r=o;break}r&&!r.addMarkerItem(e)&&(0,c.raiseWarning)(this,"1309264086","run","MapsRenderer~addMarker()","Failed to add marker. Check the options and try again.")},updateMarker:function(e,t){var o=void 0,r=void 0,n=void 0,a=this.jsVars.instanceAPI.getDatasets()||[],i=a.length;for(o=0;o<i;o++)if("markers"===(r=a[o]||[]).getName()){n=r;break}n&&e&&(e=(e+L).toLowerCase(),n.updateMarkerItem(e,t))},removeMarker:function(e){var t=void 0,o=void 0,r=void 0,n=this.jsVars.instanceAPI.getDatasets()||[],a=n.length;for(t=0;t<a;t++)if("markers"===(o=n[t]||[]).getName()){r=o;break}e&&(e=(e+L).toLowerCase(),r._removeMarkerItem(e))}},L="",A=window.Math,S=A.min,E=A.max,O=function(e){function t(e,o){var r;for(var n in y(this,t),(r=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))).subpalette="",r.key="",r.index=o,e)r.subpalette=x[e[n]],r[n]=r.subpalette instanceof Array?r.subpalette[o]:r.subpalette,r.key=n;return r}return C(t,i.default),t}(),P=function(e){function t(){var e;return y(this,t),(e=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))).friendlyName="Map",e.revision=1,e.hasCanvas=!0,e.standaloneInit=!1,e.defaultDatasetType="maps",e.defaultSeriesType="geo",e.fireGroupEvent=!0,e.legendposition="right",e.hasGradientLegend=!0,e.isMap=!0,e.defaultPaletteOptions={paletteColors:[["A6A6A6","CCCCCC","E1E1E1","F0F0F0"],["A7AA95","C4C6B7","DEDFD7","F2F2EE"],["04C2E3","66E7FD","9CEFFE","CEF8FF"],["FA9101","FEB654","FED7A0","FFEDD5"],["FF2B60","FF6C92","FFB9CB","FFE8EE"]],bgColor:["FFFFFF","CFD4BE,F3F5DD","C5DADD,EDFBFE","A86402,FDC16D","FF7CA0,FFD1DD"],bgAngle:[270,270,270,270,270],bgRatio:[w,w,w,w,w],bgAlpha:["100","60,50","40,20","20,10","30,30"],toolTipBgColor:["FFFFFF","FFFFFF","FFFFFF","FFFFFF","FFFFFF"],toolTipBorderColor:["545454","545454","415D6F","845001","68001B"],baseFontColor:["555555","60634E","025B6A","A15E01","68001B"],tickColor:["333333","60634E","025B6A","A15E01","68001B"],trendColor:["545454","60634E","415D6F","845001","68001B"],plotFillColor:["545454","60634E","415D6F","845001","68001B"],borderColor:["767575","545454","415D6F","845001","68001B"],borderAlpha:[50,50,50,50,50]},e.colorPaletteMap=F,e.eiMethods=_,e.registerFactory("legend",v.default,["canvas"]),e.registerFactory("axis",function(){},["canvas"]),e.registerFactory("colormanager-decider",m.default,["legend"]),e.registerFactory("dataset",p.default,["colormanager-decider"]),e.registerFactory("canvas",f.default),e}return C(t,a.default),r(t,[{key:"_checkInvalidSpecificData",value:function(){return this.config.invalid=!1,!1}},{key:"__setDefaultConfig",value:function(){var e=this.config;e.baseWidth||(e.baseWidth=400),e.baseHeight||(e.baseHeight=300),e.baseScaleFactor||(e.baseScaleFactor=1)}},{key:"getName",value:function(){return this.config.name||"GEO"}},{key:"getType",value:function(){return"chartAPI"}},{key:"configureAttributes",value:function(e){var o,r=this,a=r.getChildren("colorPalette")&&r.getChildren("colorPalette")[0];o=e.chart=e.chart||e.graph||e.map||{},r.jsonData=e,(0,u.componentFactory)(r,h.default,"mapAnnotations"),a||(a=new O(this.colorPaletteMap,(0<o.palette&&6>o.palette?o.palette:(0,u.pluckNumber)(r.paletteIndex,1))-1),r.attachChild(a,"colorPalette")),r.config.skipCanvasDrawing=!0,n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"configureAttributes",this).call(this,e),r._parseBackgroundCosmetics()}},{key:"parseChartAttr",value:function(e){var o,r,a,i,l=void 0,s=this,c=s.jsonData,d=c.chart||c.map,h=c.markers,g=new O(this.colorPaletteMap,(0<d.palette&&6>d.palette?d.palette:(0,u.pluckNumber)(s.paletteIndex,1))-1),p=(0,u.pluck)(d.entitybordercolor,d.bordercolor,g.plotbordercolor),f=(0,u.pluck)(d.entityfillcolor,d.fillcolor,g.plotfillcolor),m=(0,u.pluck)(d.entityfillalpha,d.fillalpha,g.plotfillalpha),v=(0,u.pluck)(d.entityfillratio,d.fillratio,g.plotfillratio),b=(0,u.pluck)(d.entityfillangle,d.fillangle,g.plotfillangle),y=(0,u.pluck)(d.nullentityfillcolor,d.nullentitycolor,f),k=(0,u.pluckNumber)(d.usevaluesformarkers,c.markers&&c.markers.items&&c.markers.items.length,!(c.markers&&c.markers.application&&c.markers.application.length&&c.markers.definition&&c.markers.definition.length));n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"parseChartAttr",this).call(this,e),(l=s.config).origMarginTop=(0,u.pluckNumber)(d.charttopmargin,d.maptopmargin,11),l.origMarginLeft=(0,u.pluckNumber)(d.chartleftmargin,d.mapleftmargin,11),l.origMarginBottom=(0,u.pluckNumber)(d.chartbottommargin,d.mapbottommargin,11),l.origMarginRight=(0,u.pluckNumber)(d.chartrightmargin,d.maprightmargin,11),l.labelsOnTop=(0,u.pluckNumber)(d.entitylabelsontop,1),o=(i=l.style).inCancolor,r=i.inCanfontFamily,a=i.inCanfontSize,l.entityOpts={baseScaleFactor:l.baseScaleFactor,dataLabels:{style:{fontFamily:r,fontSize:a,lineHeight:i.inCanLineHeight,color:i.inCancolor}},fillColor:f,fillAlpha:m,fillRatio:v,fillAngle:b,borderColor:p,borderAlpha:(0,u.pluck)(d.entityborderalpha,d.borderalpha,s.borderAlpha,"100"),borderThickness:(0,u.pluckNumber)(d.showentityborder,d.showborder,1)?(0,u.pluckNumber)(d.entityborderthickness,d.borderthickness,1):0,scaleBorder:(0,u.pluckNumber)(d.scaleentityborder,d.scaleborder,0),hoverFillColor:(0,u.pluck)(d.entityfillhovercolor,d.hoverfillcolor,d.hovercolor,g.plothoverfillcolor),hoverFillAlpha:(0,u.pluck)(d.entityfillhoveralpha,d.hoverfillalpha,d.hoveralpha,g.plothoverfillalpha),hoverFillRatio:(0,u.pluck)(d.entityfillhoverratio,d.hoverfillratio,d.hoverratio,g.plothoverfillratio),hoverFillAngle:(0,u.pluck)(d.entityfillhoverangle,d.hoverfillangle,d.hoverangle,g.plothoverfillangle),hoverBorderThickness:(0,u.pluck)(d.entityborderhoverthickness,d.hoverborderthickness),hoverBorderColor:(0,u.pluck)(d.entityborderhovercolor,p,g.plotbordercolor),hoverBorderAlpha:(0,u.pluck)(d.entityborderhoveralpha,g.plotborderalpha),nullEntityColor:y,nullEntityAlpha:(0,u.pluck)(d.nullentityfillalpha,d.nullentityalpha,m),nullEntityRatio:(0,u.pluck)(d.nullentityfillratio,d.nullentityratio,v),nullEntityAngle:(0,u.pluck)(d.nullentityfillangle,d.nullentityangle,b),connectorColor:(0,u.pluck)(d.labelconnectorcolor,d.connectorcolor,o),connectorAlpha:(0,u.pluck)(d.labelconnectoralpha,d.connectoralpha,"100"),connectorThickness:(0,u.pluckNumber)(d.labelconnectorthickness,d.borderthickness,1),showHoverEffect:(0,u.pluckNumber)(d.showentityhovereffect,d.usehovercolor,d.showhovereffect,1),hoverOnNull:(0,u.pluckNumber)(d.hoveronnull,d.entityhoveronnull,1),labelPadding:(0,u.pluckNumber)(d.labelpadding,5),showLabels:(0,u.pluckNumber)(d.showlabels,1),labelsOnTop:(0,u.pluckNumber)(d.entitylabelsontop,1),includeNameInLabels:(0,u.pluckNumber)(d.includenameinlabels,1),includeValueInLabels:(0,u.pluckNumber)(d.includevalueinlabels,0),useSNameInTooltip:(0,u.pluckNumber)(d.usesnameintooltip,0),useShortName:(0,u.pluckNumber)(d.usesnameinlabels,1),labelSepChar:(0,u.pluck)(d.labelsepchar,", "),showTooltip:(0,u.pluckNumber)(d.showentitytooltip,d.showtooltip,1),tooltipSepChar:(0,u.pluck)(d.tooltipsepchar,", "),tooltext:d.entitytooltext,hideNullEntities:(0,u.pluckNumber)(d.hidenullentities,0),showHiddenEntityBorder:(0,u.pluckNumber)(d.showhiddenentityborder,1),showNullEntityBorder:(0,u.pluckNumber)(d.shownullentityborder,1),hiddenEntityColor:(0,u.pluck)(d.hiddenentitycolor,d.hiddenentityfillcolor,d.hiddenentityalpha||d.hiddenentityfillalpha?y:"ffffff"),hiddenEntityAlpha:(0,u.pluck)(d.hiddenentityalpha,d.hiddenentityfillalpha,.001),shadow:(0,u.pluckNumber)(d.showshadow,s.defaultPlotShadow,g.shadow)},l.markerOpts={dataLabels:{style:{fontFamily:(0,u.pluck)(d.markerfont,r),fontSize:(0,u.pluckNumber)(d.markerfontsize,parseInt(a,10)),fontColor:(0,u.pluck)(d.markerfontcolor,o)}},showTooltip:(0,u.pluckNumber)(d.showmarkertooltip,d.showtooltip,1),showLabels:(0,u.pluckNumber)(d.showmarkerlabels,d.showlabels,1),showHoverEffect:(0,u.pluckNumber)(d.showmarkerhovereffect,1),labelPadding:(0,u.pluck)(d.markerlabelpadding,"5"),labelWrapWidth:(0,u.pluckNumber)(d.markerlabelwrapwidth,0),labelWrapHeight:(0,u.pluckNumber)(d.markerlabelwrapheight,0),fillColor:(0,u.pluck)(d.markerfillcolor,d.markerbgcolor,g.markerfillcolor),fillAlpha:(0,u.pluck)(d.markerfillalpha,g.markerfillalpha),fillAngle:(0,u.pluck)(d.markerfillangle,g.markerfillangle),fillRatio:(0,u.pluck)(d.markerfillratio,g.markerfillratio),fillPattern:(0,u.pluck)(d.markerfillpattern,g.markerbgpattern),hoverFillColor:d.markerfillhovercolor,hoverFillAlpha:d.markerfillhoveralpha,hoverFillRatio:d.markerfillhoverratio,hoverFillAngle:d.markerfillhoverangle,borderThickness:(0,u.pluck)(d.markerborderthickness,1),borderColor:(0,u.pluck)(d.markerbordercolor,g.markerbordercolor),borderAlpha:(0,u.pluckNumber)(d.markerborderalpha,g.markerborderalpha),hoverBorderThickness:d.markerborderhoverthickness,hoverBorderColor:d.markerborderhovercolor,hoverBorderAlpha:d.markerborderhoveralpha,radius:(0,u.pluckNumber)(d.markerradius&&(0,u.trimString)(d.markerradius),7),shapeId:(0,u.pluck)(d.defaultmarkershape,"circle"),labelSepChar:(0,u.pluck)(d.labelsepchar,", "),tooltipSepChar:(0,u.pluck)(d.tooltipsepchar,", "),autoScale:(0,u.pluckNumber)(d.autoscalemarkers,0),tooltext:(0,u.pluck)(h&&h.tooltext,d.markertooltext),dataEnabled:k,valueToRadius:(0,u.pluckNumber)(d.markerradiusfromvalue,1),valueMarkerAlpha:(0,u.pluck)(d.valuemarkeralpha,"75"),hideNull:(0,u.pluckNumber)(d.hidenullmarkers,0),nullRadius:(0,u.pluckNumber)(d.nullmarkerradius,d.markerradius,7),adjustViewPort:(0,u.pluckNumber)(d.adjustviewportformarkers,0),startAngle:(0,u.pluckNumber)(d.markerstartangle,90),maxRadius:(0,u.pluckNumber)(d.maxmarkerradius,0),minRadius:(0,u.pluckNumber)(d.minmarkerradius,0),applyAll:(0,u.pluckNumber)(d.applyallmarkers,0),shadow:(0,u.pluckNumber)(d.showmarkershadow,d.showshadow,0)},l.connectorOpts={showHoverEffect:(0,u.pluckNumber)(d.showconnectorhovereffect,1),thickness:(0,u.pluckNumber)(d.connectorthickness,d.markerconnthickness,"2"),color:(0,u.pluck)(d.connectorcolor,d.markerconncolor,g.markerbordercolor),alpha:(0,u.pluck)(d.connectoralpha,d.markerconnalpha,"100"),hoverThickness:(0,u.pluckNumber)(d.connectorhoverthickness,d.connectorthickness,d.markerconnthickness,"2"),hoverColor:(0,u.pluck)(d.connectorhovercolor,d.connectorcolor,d.markerconncolor,g.markerbordercolor),hoverAlpha:(0,u.pluck)(d.connectorhoveralpha,d.connectoralpha,d.markerconnalpha,"100"),dashed:(0,u.pluckNumber)(d.connectordashed,d.markerconndashed,0),dashLen:(0,u.pluckNumber)(d.connectordashlen,d.markerconndashlen,3),dashGap:(0,u.pluckNumber)(d.connectordashgap,d.markerconndashgap,2),font:(0,u.pluck)(d.connectorfont,d.markerconnfont,r),fontColor:(0,u.pluck)(d.connectorfontcolor,d.markerconnfontcolor,o),fontSize:(0,u.pluckNumber)(d.connectorfontsize,d.markerconnfontsize,parseInt(a,10)),showLabels:(0,u.pluckNumber)(d.showconnectorlabels,d.showmarkerlabels,d.showlabels,1),labelBgColor:(0,u.pluck)(d.connectorlabelbgcolor,d.markerconnlabelbgcolor,g.plotfillcolor),labelBorderColor:(0,u.pluck)(d.connectorlabelbordercolor,d.markerconnlabelbordercolor,g.markerbordercolor),shadow:(0,u.pluckNumber)(d.showconnectorshadow,d.showmarkershadow,d.showshadow,0),showTooltip:(0,u.pluckNumber)(d.showconnectortooltip,d.showmarkertooltip,d.showtooltip,1),tooltext:(0,u.pluck)(h&&h.connectortooltext,d.connectortooltext),hideOpen:(0,u.pluckNumber)(d.hideopenconnectors,1)},l.adjustViewPortForMarkers=(0,u.pluckNumber)(d.adjustviewportformarkers,k)}},{key:"_attachMouseEvents",value:function(){var e=this,o=e.getFromEnv("eventListeners"),r=e.getFromEnv("chart-container");s.default.unlisten(r,u.hasTouch?"touchstart":"mousemove",t.searchMouseMove),o.push(s.default.listen(r,"touchstart mousemove",t.searchMouseMove,e))}},{key:"_searchNearestNeighbour",value:function(e){var t=void 0,o=this.getDatasets()[1];if(o){if(!o.components.kDTree)return;(t=o.getElement(e))?this.config.lastHoveredPoint!==t&&o.highlightPoint(t):o.highlightPoint(!1)}}},{key:"_createLayers",value:function(){n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_createLayers",this).call(this),this._attachMouseEvents()}},{key:"_parseBackgroundCosmetics",value:function(){var e,t=this,o=t.getChildren("background")[0].config,r=t.getChildren("colorPalette")[0],n=t.getFromEnv("chart-attrib");e=o.showBorder=(0,u.pluckNumber)(n.showcanvasborder,1),o.borderWidth=e?(0,u.pluckNumber)(n.canvasborderthickness,1):0,o.borderRadius=o.borderRadius=(0,u.pluckNumber)(n.canvasborderradius,0),o.borderDashStyle=o.borderDashStyle=(0,u.pluckNumber)(n.borderdashed,0)?(0,u.getDashStyle)((0,u.pluckNumber)(n.borderdashlen,4),(0,u.pluckNumber)(n.borderdashgap,2)):"none",o.borderAlpha=(0,u.pluck)(n.canvasborderalpha,r.borderAlpha),o.borderColor=o.borderColor=(0,d.convertColor)((0,u.pluck)(n.canvasbordercolor,r&&r.borderColor),o.borderAlpha)}},{key:"_getBackgroundCosmetics",value:function(){var e=this,t=e.getFromEnv("chart-attrib")||e.jsonData.map,o=e.getChildren("colorPalette")[0];return{FCcolor:{color:(0,u.pluck)(t.bgcolor,t.canvasbgcolor,o.bgcolor),alpha:(0,u.pluck)(t.bgalpha,t.canvasbgalpha,o.bgalpha),angle:(0,u.pluck)(t.bgangle,t.canvasbgangle,o.bgangle),ratio:(0,u.pluck)(t.bgratio,t.canvasbgratio,o.bgratio)}}}},{key:"_parseCanvasCosmetics",value:function(){n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_parseCanvasCosmetics",this).call(this);var e=this,o=e.config,r=e.getFromEnv("chart-attrib")||e.jsonData.map,a=e.getChildren("canvas")[0].config;o.origMarginTop=(0,u.pluckNumber)(r.maptopmargin,11),o.origMarginLeft=(0,u.pluckNumber)(r.mapleftmargin,11),o.origMarginBottom=(0,u.pluckNumber)(r.mapbottommargin,11),o.origMarginRight=(0,u.pluckNumber)(r.maprightmargin,11),o.origCanvasLeftMargin=(0,u.pluckNumber)(r.canvasleftmargin,0),o.origCanvasRightMargin=(0,u.pluckNumber)(r.canvasrightmargin,0),o.origCanvasTopMargin=(0,u.pluckNumber)(r.canvastopmargin,0),o.origCanvasBottomMargin=(0,u.pluckNumber)(r.canvasbottommargin,0),a.canvasBorderRadius=(0,u.pluckNumber)(r.canvasborderradius,0),a.origCanvasTopPad=(0,u.pluckNumber)(r.canvastoppadding,0),a.origCanvasBottomPad=(0,u.pluckNumber)(r.canvasbottompadding,0),a.origCanvasLeftPad=(0,u.pluckNumber)(r.canvasleftpadding,0),a.origCanvasRightPad=(0,u.pluckNumber)(r.canvasrightpadding,0)}},{key:"preliminaryScaling",value:function(){for(var e=void 0,t=void 0,o=void 0,r=this.jsonData,n=r.markers&&r.markers.items||[],a=n&&n.length||0,i=1/0,l=1/0,s=-1/0,c=-1/0;a--;)e=+(o=n[a]).x,t=+o.y,i=S(i,e),l=S(l,t),s=E(s,e),c=E(c,t);return{x:i,y:l,x1:s,y1:c}}},{key:"getScalingParameters",value:function(e,t,o,r){var n=void 0,a=void 0,i=e/t,l=o/(e*this.config.baseScaleFactor),s=r/(t*this.config.baseScaleFactor),c=0,u=0;return l>s?(c+=(o-r*i)/2,a=200/(t*(n=s))):(u+=(r-o/i)/2,a=200/(e*(n=l))),{scaleFactor:n,strokeWidth:a,translateX:c,translateY:u}}},{key:"calculateMarkerBounds",value:function(e,t,o){var r,n=void 0,a=void 0,i=void 0,l=void 0,s=void 0,c=void 0,u=void 0,d=void 0,h=void 0,g=void 0,p=void 0,f=this,m=f.config,v=m.markerOpts,b=f.getDatasets(),y=f.getDataLimits(),k=y.dataMin,C=y.dataMax,x=v.hideNull,w=v.nullRadius,F=v.valueToRadius,_=1/0,L=1/0,A=-1/0,O=-1/0;for(c=0,r=b.length;c<r;c++)"markers"===(u=b[c]).getName()&&(n=u);if(n)for(c in n.calculateMarkerRadiusLimits(),i=(a=n.config||{}).minRadius,l=a.maxRadius,s=n.components&&n.components.markerObjs||{})p=(m=s[c].config).definition||{},null!==m.cleanValue?(F&&void 0===p.radius&&(m.radius=i+(l-i)*(m.cleanValue-k)/(C-k)),g=+m.radius,d=(+p.x+t)*e,h=(+p.y+o)*e,_=S(_,d-g),L=S(L,h-g),A=E(A,d+g),O=E(O,h+g)):x?m.__hideMarker=!0:null===m.radius&&(m.radius=w);return{x:_,y:L,x1:A,y1:O}}},{key:"_spaceManager",value:function(){var e,t,o,r=void 0,n=void 0,a=void 0,i=void 0,l=void 0,s=void 0,c=this,d=c.config,h=c.getChildren("legend")&&c.getChildren("legend")[0],g=h&&h.config.legendPos,p=c.getFromEnv("chart-attrib"),f=d.showBorder,m=d.origMarginLeft,v=d.origMarginTop,b=c.config.baseWidth,y=c.config.baseHeight,k={},C=0,x=0,w=d.markerOpts,F=d.borderWidth=f?(0,u.pluckNumber)(p.borderthickness,1):0;c._allocateSpace({top:F,bottom:F,left:F,right:F}),c._allocateSpace(c._manageActionBarSpace&&c._manageActionBarSpace(.225*d.availableHeight)||{}),t="right"===g?.3*d.canvasWidth:.3*d.canvasHeight,d.showLegend&&c._manageLegendSpace(t),e="bottom"===g?.225*d.canvasHeight:.225*d.canvasWidth,o=c._manageChartMenuBar(e),n=d.canvasWidth,a=d.canvasHeight,w.dataEnabled?(d.adjustViewPortForMarkers?((k=c.preliminaryScaling()).x1>b&&(b=k.x1),0>k.x&&(b+=-k.x,C=-k.x),k.y1>y&&(y=k.y1),0>k.y&&(y+=-k.y,x=-k.y),r=c.getScalingParameters(b,y,n,a),l=a,s=n,0>(k=c.calculateMarkerBounds(r.scaleFactor*c.config.baseScaleFactor,C,x)).x&&(m+=-k.x,n+=k.x),0>k.y&&(v+=-k.y,a+=k.y),k.x1>s&&(n-=k.x1-s),k.y1>l&&(a-=k.y1-l)):(r=c.getScalingParameters(b,y,n,a),c.calculateMarkerBounds(r.scaleFactor*c.config.baseScaleFactor,C,x)),m+=C*(r=c.getScalingParameters(b,y,n,a)).scaleFactor*c.config.baseScaleFactor,v+=x*r.scaleFactor*c.config.baseScaleFactor):r=c.getScalingParameters(b,y,n,a),c.config.scalingParams=r,i=r.scaleFactor,r.translateX+=m,r.translateY=r.translateY+v+o.top||0,r.sFactor=i*c.config.baseScaleFactor*100/100,r.transformStr=["t",r.translateX,",",r.translateY,"s",i,",",i,",0,0"].join(""),c.config.annotationConfig={id:"Geo",showbelow:0,autoscale:0,grpxshift:r.translateX?r.translateX:0,grpyshift:r.translateY?r.translateY:0,xscale:100*(i?i*c.config.baseScaleFactor:1),yscale:100*(i?i*c.config.baseScaleFactor:1),scaletext:1,options:{useTracker:!0}},c.getChildren("mapAnnotations")[0].clear(),c.getChildren("mapAnnotations")[0].configureAttributes()}},{key:"getDataLimits",value:function(){var e=void 0,t=void 0,o=this.getDatasets(),r=o.length,n=1/0,a=-1/0;for(t=0;t<r;t++)e=o[t].getDataLimits(),n=S(n,e.min),a=E(a,e.max);return{dataMin:n,dataMax:a}}},{key:"getEntityPaths",value:function(e){var t=void 0,o={},r=this.config.entities;if(e){for(t in r)o[t]=r[t];return o}return r}},{key:"checkComplete",value:function(){var e=this;e.config.entityFlag&&e.config.entitiesReady&&(e.config.entityFlag=!1,e.config.markersDrawn=!0,e.fireChartInstanceEvent("internal.mapdrawingcomplete",{renderer:e}))}}],[{key:"getName",value:function(){return"maps"}},{key:"getType",value:function(){return"chartAPI"}},{key:"searchMouseMove",value:function(e){var t=void 0,o=e.data,r=o.config,n={};!o.getFromEnv("chart-container")||(t=function(e,t){var o=(0,u.getMouseCoordinate)(t.getFromEnv("chart-container"),e),r=o.chartX,n=o.chartY,a=t.config,i=a.canvasLeft,l=a.canvasTop,s=a.canvasLeft+a.canvasWidth,c=a.canvasHeight+a.canvasTop;return o.insideCanvas=!1,o.originalEvent=e,r>i&&r<s&&n>l&&n<c&&(o.insideCanvas=!0),o}(e,o))&&t.insideCanvas&&(r.lastMouseEvent=e,n={x:t.chartX,y:t.chartY},o._searchNearestNeighbour(n))}}]),t}();t.default=P},464:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),n=s(o(140)),a=o(145),i=s(o(465)),l=s(o(143));function s(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))).registerFactory("dataset",i.default,["vCanvas"]),e.registerFactory("legend",l.default),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n.default),r(t,[{key:"getName",value:function(){return"MSCartesian"}},{key:"getType",value:function(){return"chartAPI"}},{key:"_createLayers",value:function(){(function e(t,o,r){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,o);if(void 0===n){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,o,r)}if("value"in n)return n.value;var i=n.get;return void 0!==i?i.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_createLayers",this).call(this);var e=this.getFromEnv("animationManager");this.getChildContainer("legendGroup")||this.addChildContainer("legendGroup",e.setAnimation({el:"group",attr:{name:"legend"},component:this,container:this.getContainer("parentgroup"),label:"group"}))}},{key:"_manageLegendSpace",value:function(){a._manageLegendSpace.call(this)}},{key:"manageGradientLegendSpace",value:function(e){return a.manageGradientLegendSpace.call(this,e)}}],[{key:"getName",value:function(){return"MSCartesian"}}]),t}();t.default=c},465:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=void 0,o=void 0,n=void 0,a=void 0,i=e.getFromEnv("dataSource").dataset,l=t=e.getChildren().canvas[0].getChildren("vCanvas")[0],s=e.config.defaultDatasetType||"";return i?((n=e.getDSGroupdef())&&((0,r.componentFactory)(t,n,"datasetGroup_"+s,1,[i]),a=t.getChildren("datasetGroup_"+s)),a&&(l=a[0]),o=e.getDSdef(),void(0,r.datasetFactory)(l,o,"dataset",i.length,i)):void e.setChartMessage()};var r=o(0)},466:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,o=e.getFromEnv("dataSource"),l=o.data||{},s=o.markers;(0,r.componentFactory)(e,i.default,"mapGroup"),t=e.getChildren("mapGroup")[0],(0,r.datasetFactory)(t,n.default,"entities",1,[l]),s?(0,r.datasetFactory)(t,a.default,"markers",1,[s]):e.getDatasets()[1]&&e.getDatasets()[1].remove()};var r=o(0),n=l(o(462)),a=l(o(468)),i=l(o(470));function l(e){return e&&e.__esModule?e:{default:e}}},467:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(e){var t,o,n,a=window.parseFloat,i=e._createNode,l=e._setFillAndStroke,s=e.el.constructor,c={Q:"L",Z:"X",q:"l",z:"x",",":" "},u=/,?([achlmqrstvxz]),?/gi,d=function(){return this.join(",").replace(u,t)};e.svg?(t="$1",o=function(){var o=e.is(arguments[0],"array")?arguments[0]:Array.prototype.slice.call(arguments);o?"string"==typeof o?o=o.replace(u,t):o.toString=d:o="M0,0",this.node.setAttribute("d",o.toString())},e._engine.litepath=function(t,o,r,n,a){var c,u=i("path");return(n||o).canvas.appendChild(u),(c=new s(u,o,n)).type="litepath",c.id=u.raphaelid=e._oid++,u.raphael=!0,l(c,a||{fill:"none",stroke:"#000"}),c},e._getPath.litepath=function(t){return e.parsePathString(t.node.getAttribute("d"))}):e.vml&&(t=function(e,t){return c[t]||t},n=function(){var e=this;return e._transform.apply(e,arguments),e._.bcoord&&(e.node.coordsize=e._.bcoord),e},o=function(e){return e?"string"==typeof e?e=e.replace(u,t):e.toString=d:e="M0,0",this.node.path=e,this},e._engine.litepath=function(t,o,r,l,c){var u,d=i("shape"),h=d.style,g=new s(d,o,l);return h.cssText="position:absolute;left:0;top:0;width:21600px;height:21600px;",r=a(r),isNaN(r)?d.coordsize="21600 21600":(g._.bzoom=r,h.width="1px",h.height="1px",d.coordsize=g._.bcoord=r+" "+r),d.coordorigin=o.coordorigin,g.type="litepath",g.id=d.raphaelid=e._oid++,d.raphael=!0,g._transform=g.transform,g.transform=n,e._setFillAndStroke(g,c||{fill:"none",stroke:"#000"}),(l||o).canvas.appendChild(d),(u=i("skew")).on=!0,d.appendChild(u),g.skew=u,g},e._getPath.litepath=function(t){return e.parsePathString(t.node.path||"")}),e.fn.litepath=function(t,n,a){var i,l,c;return"object"==(void 0===t?"undefined":r(t))&&t.constructor!==s&&(i=t,l=(t=t.litepath).zoom,a=t.group),n&&n.constructor===s?(a=n,l=void 0):l=n,t&&t.constructor===s&&(a=t,t=""),(c=e._engine.litepath(t,this,l,a,i)).ca.litepath=o,t&&c.attr("litepath",e.is(t,"array")?[t]:t),this.__set__&&this.__set__.push(c),this._elementsById[c.id]=c}}},468:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),n=h(o(462)),a=h(o(469)),i=o(5),l=h(o(461)),s=o(0),c=o(4),u=o(8),d=o(9);function h(e){return e&&e.__esModule?e:{default:e}}var g=void 0,p=window.navigator.userAgent,f=/msie/i.test(p)&&!window.opera,m="top",v="bottom",b="right",y="left",k="middle",C="center",x=window.Math,w=x.min,F=x.max,_=Math.PI/180,L="rgba(192,192,192,"+(f?.002:1e-6)+")",A=function(e,t){var o=t?(0,s.extend2)(e.FCcolor,t,!1,!0):{FCcolor:e};return o.toString=s.toRaphaelColor,o},S=function(e,t){var o=void 0,r=e&&e.length||!1,n=t||"id",a={};if(!e)return e;for(;r--;)(o=e[r])[n]!==g&&(a[o[n].toLowerCase()]=o);return a};(0,i.addDep)({name:"mapsAnimation",type:"animationRule",extension:l.default});var E=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))).components={},e.getLabelAlignment={top:function(e,t,o){return{x:e.toString(),y:(t-o).toString(),align:C,valign:m}},left:function(e,t,o){return{x:(e-o).toString(),y:t.toString(),align:b,valign:k}},right:function(e,t,o){return{x:(e+o).toString(),y:t.toString(),align:y,valign:k}},bottom:function(e,t,o){return{x:e.toString(),y:(t+o).toString(),align:C,valign:v}},center:function(e,t){return{x:e.toString(),y:t.toString(),align:C,valign:k}}},e.getWrapWidth={right:function(){return arguments[1]},left:function(e,t){return e-t},center:function(e,t){return 2*w(t,e-t)}},e.getWrapHeight={top:function(){return arguments[1]},middle:function(e,t){return 2*w(t,e-t)},bottom:function(e,t){return e-t}},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n.default),r(t,[{key:"getName",value:function(){return"markers"}},{key:"getType",value:function(){return"dataset"}},{key:"configureAttributes",value:function(e){if(e){this.JSONData=e;var t=this.getFromEnv("chart").config.markerOpts;this.calculateDataLimits(),t.dataEnabled?this._parseMarkers():this.defineMarkersNShapes(),this.configureConnectors()}}},{key:"calculateMarkerRadiusLimits",value:function(){if(this.JSONData){var e=this,o=e.JSONData,r=e.config,n=e.getFromEnv("chart"),a=n.config.width,i=n.config.height,l=o.markermaxradius,s=o.markerminradius,c=t.getMarkerRadiusLimits(a,i,l,s);r.minRadius=c.min,r.maxRadius=c.max}}},{key:"calculateDataLimits",value:function(){var e,t=void 0,o=void 0,r=void 0,n=this.getFromEnv("chart"),a=this.config,i=(n.jsonData.markers||{}).items||[],l=this.getFromEnv("number-formatter"),s=1/0,c=-1/0;for(r=0,e=i.length;r<e;r++)o=i[r].value,null!==(t=l.getCleanValue(o))&&(s=w(t,s),c=F(t,c));a.min=s,a.max=c}},{key:"_parseMarkers",value:function(){var e=void 0,o=void 0,r=void 0,n=void 0,a=void 0,i=void 0,l=void 0,c=void 0,u=this,d=u.getFromEnv("chart"),h=d.jsonData.markers,p=h.items,f=h.shapes,m=d.config.markerOpts,v=this.getFromEnv("number-formatter"),b=u.components.shapeObjs={},y=u.components.markerObjs={};if(p&&p.length){if(f&&f.length)for(o=f.length;o;o-=1)(c=(n=f[o-1]).id.toLowerCase())&&(b[c]=n);for(o=p.length;o--;)(c=(n=p[o]).id&&n.id.toLowerCase())&&((e=n.value)!==g&&""!==e&&(e=parseFloat(e)),(a=(r=t._initializeMarkerItem(c,n,null,d)).config.options.shapeid)&&"string"==typeof a&&(a=a.toLowerCase()),l=(i=r.config).options,i.cleanValue=v.getCleanValue(e),i.formattedValue=null===i.cleanValue?g:v.dataLabels(e),i.fillColor=(0,s.pluck)(l.fillcolor,l.color,m.fillColor),i.fillAlpha=(0,s.pluck)(l.fillalpha,l.alpha,m.fillAlpha),i.fillRatio=(0,s.pluck)(l.fillratio,m.fillRatio),i.fillAngle=(0,s.pluck)(l.fillangle,m.fillAngle),i.borderThickness=(0,s.pluckNumber)(l.borderthickness,m.borderThickness),i.borderColor=(0,s.pluck)(l.bordercolor,m.borderColor),i.borderAlpha=(0,s.pluck)(l.borderalpha,m.borderAlpha),i.labelPadding=l.labelpadding||m.labelPadding,r.dataset=u,n.__hideMarker&&(r._isHidden=!0),a&&(r.shapeObj=b[a]),y[c]=r)}}},{key:"defineMarkersNShapes",value:function(){var e=void 0,o=void 0,r=void 0,n=void 0,a=void 0,i=void 0,l=void 0,c=void 0,u=this,d=u.getFromEnv("chart"),h=d.jsonData.markers,p=h.definition,f=this.getFromEnv("number-formatter"),m=d.config.markerOpts,v=S(p)||{},b=S(h.application)||{},y=h.shapes,k=u.components.shapeObjs=u.components.shapeObjs||(u.components.shapeObjs={}),C=u.components.markerObjs=u.components.markerObjs||(u.components.markerObjs={});if(p&&p.length){if(y&&y.length)for(n=y.length;n;n-=1)(c=(i=y[n-1]).id.toLowerCase())&&(k[c]=i);for(c in v)i=v[c],(a=C[c]=t._initializeMarkerItem(c,i,b[c],d)).dataset=u,l=a.config.options.shapeid,o=a.config,r=i.value,o.cleanValue=f.getCleanValue(r),e=o.options,o.formattedValue=null===o.cleanValue?g:f.dataLabels(r),o.fillColor=(0,s.pluck)(e.fillcolor,e.color,m.fillColor),o.fillAlpha=(0,s.pluck)(e.fillalpha,e.alpha,m.fillAlpha),o.fillRatio=(0,s.pluck)(e.fillratio,m.fillRatio),o.fillAngle=(0,s.pluck)(e.fillangle,m.fillAngle),o.borderThickness=(0,s.pluckNumber)(e.borderthickness,m.borderThickness),o.borderColor=(0,s.pluck)(e.bordercolor,m.borderColor),o.borderAlpha=(0,s.pluck)(e.borderalpha,m.borderAlpha),o.labelPadding=e.labelpadding||m.labelPadding,o.options.tooltext=(0,s.pluck)(e.tooltext,m.tooltext),o.link=e.link,l&&(a.shapeObj=k[l.toLowerCase()])}}},{key:"getDataLimits",value:function(){var e=this.config;return{min:e.min,max:e.max}}},{key:"configureConnectors",value:function(){var e=void 0,t=void 0,o=void 0,r=void 0,n=void 0,a=void 0,i=void 0,l=void 0,c=void 0,u=void 0,d=void 0,h=void 0,g=void 0,p=void 0,f=this,m=f.getFromEnv("chart"),v=m.jsonData,b=f.components,y=v.markers||{},x=y.connector||y.connectors||[],w=b.markerObjs,F=x.length,_=f.components.connectors,L=function(e){return function(t){var o=this,r=o.getElement();r&&o.unfilteredConfig.hoverEffect&&r.attr(o.unfilteredConfig._hoverAttrs),m.fireChartInstanceEvent("connectorrollover",e,t)}},S=function(e){return function(t){var o=this,r=o.getElement();r&&o.unfilteredConfig.hoverEffect&&r.attr(o.unfilteredConfig._defaultAttrs),m.fireChartInstanceEvent("connectorrollout",e,t)}},E=function(e){return function(t){m.fireChartInstanceEvent("connectorClick",e,t)}},O=m.config.connectorOpts,P={};for(_=f.components.connectors=[],p=0;p<F;p++)((g=x[p]).from||g.to)&&(t=w[g.from.toLowerCase()],o=w[g.to.toLowerCase()],t&&o)&&(r=x[p].label,(P=_[p])||(P=_[p]={}),P.config||(e=P.config={}),P.graphics||(P.graphics={}),(e=P.config=(0,s.extend2)({},g)).fromMarker=t,e.toMarker=o,e.link=g.link,e.showTooltip=(0,s.pluckNumber)(g.showtooltip,O.showTooltip),n=e.tooltext=e.showTooltip?(0,s.pluck)(g.tooltext,O.tooltext):"",a=e.thickness=(0,s.pluck)(g.thickness,O.thickness),i=e.color=(0,s.pluck)(g.color,O.color),l=e.alpha=(0,s.pluck)(g.alpha,O.alpha),e.hoverEffect=(0,s.pluckNumber)(g.showhovereffect,O.showHoverEffect),c=(0,s.pluck)(g.hovercolor,O.hoverColor,i),u=(0,s.pluck)(g.hoveralpha,O.hoverAlpha,l),d=(0,s.pluck)(g.hoverthickness,O.hoverThickness,a),e.dashed=(0,s.pluck)(g.dashed,O.dashed),e.dashLen=(0,s.pluckNumber)(g.dashlen,O.dashlen),e.dashGap=(0,s.pluckNumber)(g.dashgap,O.dashgap),n&&(e.tooltext=n=(0,s.parseUnsafeString)((0,s.parseTooltext)(n,[3,40,41,42,43],{label:r,fromId:t.config.definition.id,toId:o.config.definition.id,fromLabel:t.config.definition.label,toLabel:o.config.definition.label},void 0))),e.eventArgs={fromMarkerId:t.config.id,toMarkerId:o.config.id,label:r},e._hoverAttrs={stroke:A({color:c,alpha:u}).toString(),"stroke-width":d},e._defaultAttrs={stroke:A({color:i,alpha:l}).toString(),"stroke-width":a},e.type="line",e.onclick=E(e.eventArgs),e.onmouseover=L(e.eventArgs),e.onmouseout=S(e.eventArgs),r&&(!(h=P.labelConfig)&&(h=P.labelConfig={}),h.type="text",h.text=r,h.align=C,h.valign=k,h.font=O.font,h.fillcolor=O.fontColor,h.bgcolor=O.labelBgColor,h.bordercolor=O.labelBorderColor,h.tooltext=e.tooltext))}},{key:"draw",value:function(){var e=void 0,t=void 0,o=void 0,r=void 0,n=void 0,a=void 0,i=void 0,l=this,s=l.getFromEnv("chart"),c=l.config,u=s.getChildren("mapAnnotations")[0],h=l.components.markerObjs,g=s.config,p=g.markerOpts,f=g.scalingParams,m=s.config.annotationConfig,v=l.getFromEnv("toolTipController"),b=[],y=[],k={};for(r in this._drawConnectors(),l.imageLoadCount=0,l.imageCount=0,i=u.addGroup(Object.assign(m,{id:"markers",fillalpha:"100",items:b,scaleimages:1}),l),a=u.addGroup(Object.assign(m,{id:"markerLabels",items:y,scaleimages:1}),l),g.labelsOnTop&&s.getChildren("mapLabelAnnotations")&&s.getChildren("mapLabelAnnotations")[0].annotation.groups[0].store.element.toFront(),l.components.markerGroup=i,l.components.markerLabelGroup=a,c.autoScale=p.autoScale?f.sFactor:1,h)e=null,(o=(t=h[r]).config).conIsHidden||(e=this._drawMarkerItem.call(t)),e&&(o._annotationIndex=b.length,k[r]=t,t.markerShape=e.markerShape&&u.addItem(i.getId(),Object.assign({align:"center",valign:"middle",animationLabel:"markerItem"},e.markerShape),!0,l),(n=t.markerShape&&t.markerShape.getElement())&&v.enableToolTip(n,t.config.tooltext),b.push(t.markerShape),t.markerLabel=e.markerLabel&&u.addItem(a.getId(),Object.assign({animationLabel:"markerItem"},e.markerLabel),!0,l),y.push(t.markerLabel));l.addJob("buildKdtree",l._buildKdTree.bind(l),d.priorityList.kdTree)}},{key:"_buildKdTree",value:function(){var e=void 0,t=void 0,o=this,r=o.components.kdArrayMap,n=o.components.markerGroup,i=[],l=n&&n.items,s=l&&l.length||0;for(t=0;t<s;t++)r[e=l[t].config.id]&&i.push(r[e]);o.components.kDTree||(o.components.kDTree=new a.default(!0)),o.components.kDTree._setSearchLimit(1/0,1/0),o.components.kDTree.buildKdTree(i)}},{key:"_drawMarkerItem",value:function(){var e=void 0,t=void 0,o=void 0,r=void 0,n=void 0,a=void 0,i=void 0,l=void 0,u=void 0,d=void 0,h=void 0,p=void 0,f=void 0,v=void 0,b=void 0,y=void 0,k=void 0,C=void 0,x=void 0,w=void 0,F=this,_=F.dataset,L=_.getFromEnv("chart"),A=L.config,S=_.config,E=A.scalingParams,O=F.config,P=O.options,N=O.definition,I=A.markerOpts,T=I.dataLabels.style,R=P.shapeid,M=P.scale||1,j=P.label||"",B=L.config.scalingParams.scaleFactor*L.config.baseScaleFactor,D=(P.labelpos||m).toLowerCase(),V=O.formattedValue===g?g:O.formattedValue,G=P.tooltext||I.tooltext,H=(0,s.pluckNumber)(N.radius,O.radius,I.radius)*M*S.autoScale||1e-4,W=O.fillColor,z=O.fillAlpha,X=O.fillRatio,K=O.fillAngle,Y=O.borderThickness,U=O.borderColor,J=O.borderAlpha,Z=_.components.kdArrayMap||(_.components.kdArrayMap={}),q=F.config.id;if(O.autoScale=I.autoScale?B:1,R)return G=G?(0,s.parseUnsafeString)((0,s.parseTooltext)(G,[1,2,3],{formattedValue:V,label:j},P)):V?j+I.tooltipSepChar+V:j,V!==g&&null!==V?j=j+I.labelSepChar+V:isNaN(M)?M=1:0>M?M=0:5<M&&(M=5),(0,s.extend2)(P,{x:P.x&&P.x.toString(),y:P.y&&P.y.toString(),fillcolor:W,fillalpha:z,fillratio:X,fillangle:K,borderthickness:Y,bordercolor:U,borderalpha:J,hovereffect:(0,s.pluck)(I.showHoverEffect),radius:H&&H.toString(),link:P.link,showshadow:(0,s.pluckNumber)(P.showshadow,O.shadow),_markerLabel:j,_markerId:P.id,id:(P.id+"").toLowerCase()}),delete P.tooltext,O.tooltext=!!I.showTooltip&&G,b=+P.x*E.sFactor+E.translateX,y=+P.y*E.sFactor+E.translateY,H=P.radius,"triangle"===R?((0,s.extend2)(P,{type:"polygon",sides:3,startangle:I.startAngle}),w="polygon",x=3):"diamond"===R?((0,s.extend2)(P,{type:"polygon",sides:4,startangle:I.startAngle}),w="polygon",x=4):"arc"===R?(C=.6*H,(0,s.extend2)(P,{type:"arc",startangle:0,endangle:360,innerradius:C}),w="arc"):"circle"===R?(P.type="circle",w="circle"):(h=_.getShapeArgs.call(F),I.dataEnabled&&I.valueToRadius&&P.radius!==g?delete h.radius:(!h.radius&&(h.radius=I.radius),h.radius*=M*O.autoScale),(0,s.extend2)(P,h),P.id=P._markerId&&P._markerId.toLowerCase(),C=h.innerradius,h.radius&&(H=h.radius),w=h.type&&h.type.toLowerCase(),x=h.sides||5,(H=+H)&&C&&H<C&&(v=H,P.radius=H=C,P.innerradius=C=v)),P.type=P.type&&P.type.toLowerCase(),(0,s.extend2)(P,{hoverfillcolor:(0,s.pluck)(P.fillhovercolor,I.hoverFillColor,P.fillcolor),hoverfillalpha:(0,s.pluck)(P.fillhoveralpha,I.hoverFillAlpha,P.fillalpha),hoverfillratio:(0,s.pluck)(P.fillhoverratio,I.hoverFillRatio,P.fillratio),hoverfillangle:(0,s.pluck)(P.fillhoverangle,I.hoverFillAngle,P.fillangle),hoverborderthickness:(0,s.pluckNumber)(P.borderhoverthickness,I.hoverBorderThickness,P.borderthickness),hoverbordercolor:(0,s.pluck)(P.borderhovercolor,I.hoverBorderColor,P.bordercolor),hoverborderalpha:(0,s.pluck)(P.borderhoveralpha,I.hoverBorderAlpha,P.borderalpha)}),p={alpha:P.fillalpha,color:P.fillcolor,angle:360-P.fillangle,ratio:P.fillratio},f={alpha:P.hoverfillalpha,color:P.hoverfillcolor,angle:360-P.hoverfillangle,ratio:P.hoverfillratio},P._defaultattrs={fill:(0,s.toRaphaelColor)(p),"stroke-width":"0"===P.showborder?0:P.borderthickness,stroke:(0,c.convertColor)(P.bordercolor,P.borderalpha)},P._hoverattrs={fill:(0,s.toRaphaelColor)(f),"stroke-width":"0"===P.showborder?0:P.hoverborderthickness,stroke:(0,c.convertColor)(P.hoverbordercolor,P.hoverborderalpha)},"image"===P.type?(P.borderthickness=P.borderthickness||0,P.onload=function(e){var t=this.config,o=e.width,r=e.height,n={},a=(+t.x-o/(2*E.sFactor))*E.sFactor,i=(+t.y-r/(2*E.sFactor))*E.sFactor;(n=Z[q]||(Z[q]={})).x=a+E.translateX,n.y=i+E.translateY,n.element=F,n.shapeInfo={type:"rect",width:o,height:r},o&&r&&this.getElement().attr({x:a,y:i,width:o,height:r}),_.imageLoadCount++,_.imageLoadCount===_.imageCount&&_._buildKdTree()},P.onerror=function(){_.imageLoadCount++,_.imageLoadCount===_.imageCount&&_._buildKdTree()},_.imageCount++):((k=Z[q]||(Z[q]={})).x=b,k.y=y,k.element=F,k.shapeInfo={type:w,sides:x,radius:+H+P.borderthickness/2,innerradius:C}),O.drawOptions.shape=P,I.showLabels?(d=P.labelpadding||I.labelPadding,t=(e=_._getLabelOptions(D,d,P)).align,o=e.valign,r=O._labelBaseWidth,n=O._labelBaseHeight,a=O._labelXOffset,i=O._labelYOffset,l=I.labelWrapWidth?I.labelWrapWidth:_.getWrapWidth[t](r,+e.x+a),u=I.labelWrapHeight?I.labelWrapHeight:_.getWrapHeight[o](n,+e.y+i),l>d&&(l-=d),u>d&&(u-=d),O.drawOptions.label=(0,s.extend2)({type:"text"},{text:j,tooltext:P.tooltext,x:e.x,y:e.y,align:t,valign:e.valign,wrap:1,wrapwidth:l,wrapheight:u,fontsize:T.fontSize/E.sFactor,font:T.fontFamily,fillcolor:T.fontColor}),{markerShape:P,markerLabel:O.drawOptions.label}):{markerShape:P}}},{key:"getHoverFn",value:function(){var e=this.getFromEnv("chart");return function(){var t=void 0,o=void 0,r=this.data("marker"),n=r.markerShape,a=n.unfilteredConfig,i=a._markerEventArgs,l=n.getElement(),c=l.getBBox(),d=r.config;l&&a.hovereffect&&("circle"===n.config.type&&(o={color:a.hoverfillcolor,alpha:a.hoverfillalpha,angle:360-a.hoverfillangle,ratio:a.hoverfillratio,gradientUnits:"objectBoundingBox",radialGradient:"radial"===n.config.rawFillPattern},a._hoverattrs.fill=(0,s.toRaphaelColor)(o)),t=(0,s.extend2)({},a._hoverattrs),"image"===l.type&&(delete t.fill,delete t.stroke,delete t["stroke-width"]),l.attr(t)),i||(i=a._markerEventArgs={x:c.x,y:c.y,scaledX:c.x/n.groupConfig.scaleX,scaledY:c.y/n.groupConfig.scaleY,chartX:c.x+c.width/2,chartY:c.y+c.height/2,id:a.id,label:a.label}),(0,u.raiseEventGroup)(d.options.id,"markerRollOver",i,e.getFromEnv("chartInstance"),d,g,g,g)}}},{key:"getHoverOutFn",value:function(){var e=this.getFromEnv("chart");return function(){var t=void 0,o=this.data("marker"),r=o.markerShape,n=r.getElement(),a=o.config,i=r.unfilteredConfig;n&&r.unfilteredConfig.hovereffect&&("circle"===r.config.type&&(i._defaultattrs.fill=(0,s.toRaphaelColor)({alpha:r.config.rawAlpha,color:r.config.rawColor,angle:360-r.config.rawAngle,ratio:r.config.rawRatio,radialGradient:"radial"===r.config.rawFillPattern})),t=(0,s.extend2)({},r.unfilteredConfig._defaultattrs),"image"===n.type&&(delete t.fill,delete t.stroke,delete t["stroke-width"]),n.attr(t)),(0,u.raiseEventGroup)(a.id,"markerRollOut",r.unfilteredConfig._markerEventArgs,e.getFromEnv("chartInstance"),g,g,g)}}},{key:"getClickFn",value:function(){var e=this;return function(t){var o=this.data("marker"),r=o.config.options,n=e.getFromEnv("chart"),a=o.markerShape,i=a.config,l=this.getBBox(),s=i._markerEventArgs;s||(s=i._markerEventArgs={x:l.x,y:l.y,scaledX:l.x/a.groupConfig.scaleX,scaledY:l.y/a.groupConfig.scaleY,chartX:l.x+l.width/2,chartY:l.y+l.height/2,id:r.id,label:r.label}),n.fireChartInstanceEvent("markerClick",s,t)}}},{key:"highlightPoint",value:function(e){var t=void 0,o=void 0,r=void 0,n=void 0,a=void 0,i=void 0,l=void 0,s=void 0,c=void 0,u=void 0,d=e.element,h=this,g=h.getFromEnv("chart"),p=g.graphics,f=h.getFromEnv("animationManager"),m=p.trackerElems||(p.trackerElems={}),v=e.shapeInfo,b=h.getFromEnv("toolTipController"),y=e.x,k=e.y,C=g.config.lastHoveredPoint,x=!1;return!1===e?((o=m[t=C&&C.shapeInfo.type])&&o.hide(),void(g.config.lastHoveredPoint=null)):(r={fill:L,stroke:L},"circle"===(t=v.type)&&(t="polygon"),o=m[t],"polygon"===t?(n=v.sides||1,a=v.startAngle,l=v.radius,!o&&(x=!0),o=p.trackerElems[t]=f.setAnimation({el:p.trackerElems[t]||"polypath",container:o,attr:Object.assign({polypath:[n,y,k,l,a]},r),component:h,label:"markers"})):"rect"===t?(i=v.width,c=v.height,!o&&(x=!0),o=p.trackerElems[t]=f.setAnimation({el:p.trackerElems[t]||"rect",container:o,attr:Object.assign({x:y,y:k,width:i,height:c},r),component:h,label:"markers"})):"arc"===t&&(s=d.markerShape.config.innerRadius,a=(360-d.markerShape.config.startAngle)*_,u=(360-d.markerShape.config.endAngle)*_,l=v.radius,!o&&(x=!0),o=p.trackerElems[t]=f.setAnimation({el:p.trackerElems[t]||"ringpath",container:o,attr:Object.assign({ringpath:[y,k,l,s,u,a]},r),component:h,label:"markers"})),g.config.lastHoveredPoint=e,x&&o.click(h.getClickFn()).hover(h.getHoverFn(),h.getHoverOutFn()),o.show().data("marker",d),void b.enableToolTip(o,d.config.tooltext))}},{key:"_drawConnectors",value:function(){var e=void 0,t=void 0,o=void 0,r=void 0,n=void 0,a=void 0,i=void 0,l=void 0,s=this,c=s.getFromEnv("chart"),u=c.config.annotationConfig,d=s.components.connectors||(s.components.connectors=[]),h=d.length,g=c.config.scalingParams,p=c.config.connectorOpts,f=p.showLabels,m=c.getChildren("mapAnnotations")[0],v=[],b=[],y=[];for(y.push({id:"connectorLabels",fillalpha:"100",items:b}),y.push({id:"connectors",fillalpha:"100",items:v}),m.addGroup(Object.assign(u,y[1]),s),m.addGroup(Object.assign(u,y[0]),s),t=0;t<h;t++)d[t]&&(i=d[t].config.fromMarker.config,l=d[t].config.toMarker.config,o=i.options.x,r=i.options.y,n=l.options.x,a=l.options.y,d[t].config.x=o,d[t].config.y=r,d[t].config.tox=n,d[t].config.toy=a,v.push(d[t].config),(e=m.addItem("connectors",Object.assign({animationLabel:"markerItem"},d[t].config),!0,s)).addEventListener("mouseover",d[t].config.onmouseover),e.addEventListener("mouseout",d[t].config.onmouseout),e.addEventListener("click",d[t].config.onclick),d[t].labelConfig&&f&&(d[t].labelConfig.x=((+o+ +n)/2).toString(),d[t].labelConfig.y=((+r+ +a)/2).toString(),d[t].labelConfig.fontsize=p.fontSize/(g.scaleFactor*c.config.baseScaleFactor),b.push(d[t].labelConfig),m.addItem("connectorLabels",Object.assign({animationLabel:"markerItem"},d[t].labelConfig),!0,s)))}},{key:"getShapeArgs",value:function(){var e=void 0,t=this.config,o=(0,s.extend2)({},this.shapeObj);return t.autoScale=1,o?("polygon"===o.type?3>o.sides?o.type="circle":o.startangle=t.startAngle:"arc"===o.type&&(e=(o.radius||t.markerRadius)*t.autoScale,o.radius=e,o.innerradius=o.innerradius&&o.innerradius*t.autoScale||.6*e),o):null}},{key:"_getLabelOptions",value:function(e,t,o,r,n){var a,i,l=void 0,s=e&&e.toLowerCase();return this.getLabelAlignment[s]||(s="center"),a=+o.x,i=+o.y,l=+(l=r===g||n===g?o.radius||0:/^(top|bottom)$/gi.test(s)&&.5*n||/^(left|right)$/gi.test(s)&&.5*r||0)+ +t,this.getLabelAlignment[s](a,i,l)}},{key:"addMarkerItem",value:function(e){var o,r=void 0,n=void 0,a=void 0,i=void 0,l=void 0,c=this,u=c.getFromEnv("chart"),d=e,h=c.components.markerObjs,p=c.components.shapeObjs,f=c.components.markerGroup,m=c.components.markerLabelGroup,v=u.getChildren("mapAnnotations")[0],b=c.getFromEnv("number-formatter"),y=u.config.markerOpts;if(o=d.id.toLowerCase()){if(h[o])return;delete d.value,c.imageLoadCount=0,(r=t._initializeMarkerItem(o,d,null)).dataset=c,l=r.config.options.shapeid,a=r.config,i=d.value,a.cleanValue=b.getCleanValue(i),e=a.options,a.formattedValue=null===a.cleanValue?g:b.dataLabels(i),a.fillColor=(0,s.pluck)(e.fillcolor,e.color,y.fillColor),a.fillAlpha=(0,s.pluck)(e.fillalpha,e.alpha,y.fillAlpha),a.fillRatio=(0,s.pluck)(e.fillratio,y.fillRatio),a.fillAngle=(0,s.pluck)(e.fillangle,y.fillAngle),a.borderThickness=(0,s.pluckNumber)(e.borderthickness,y.borderThickness),a.borderColor=(0,s.pluck)(e.bordercolor,y.borderColor),a.borderAlpha=(0,s.pluck)(e.borderalpha,y.borderAlpha),a.labelPadding=e.labelpadding||y.labelPadding,a.options.tooltext=(0,s.pluck)(e.tooltext,y.tooltext),a.link=e.link,l&&(r.shapeObj=p[l&&l.toLowerCase()]),h[o]=r,n=c._drawMarkerItem.call(r),f&&m&&(r.markerShape=n.markerShape&&v.addItem(f.getId(),Object.assign({align:"center",valign:"middle",animationLabel:"markerItem"},n.markerShape),!0,c),r.markerLabel=n.markerLabel&&v.addItem(m.getId(),Object.assign({animationLabel:"markerItem"},n.markerLabel),!0,c)),c._buildKdTree()}}},{key:"updateMarkerItem",value:function(e,t){var o=void 0,r=void 0,n=void 0,a=void 0,i=this,l=i.getFromEnv("chart"),c=l.getChildren("mapAnnotations")[0],u=i.components.markerObjs,d=l.config.markerOpts,h={},g=u[e];if(g){for(r in o=g.config.options,(0,s.extend2)(o,t),i.imageLoadCount=0,n=g.config,t)h[r.toLowerCase()]=t[r]&&t[r].toString();n.fillColor=(0,s.pluck)(h.fillcolor,h.color,d.fillColor),n.fillAlpha=(0,s.pluck)(h.fillalpha,h.alpha,d.fillAlpha),n.fillRatio=(0,s.pluck)(h.fillratio,d.fillRatio),n.fillAngle=(0,s.pluck)(h.fillangle,d.fillAngle),n.borderThickness=(0,s.pluckNumber)(h.borderthickness,d.borderThickness),n.borderColor=(0,s.pluck)(h.bordercolor,d.borderColor),n.borderAlpha=(0,s.pluck)(h.borderalpha,d.borderAlpha),n.labelPadding=h.labelpadding||d.labelPadding,n.options.tooltext=(0,s.pluck)(h.tooltext,d.tooltext),n.link=h.link,a=i._drawMarkerItem.call(g).markerShape,i._buildKdTree(),c.update(e,a)}}},{key:"_removeMarkerItem",value:function(e){var t=void 0,o=void 0,r=this.components,n=r.markerObjs,a=n[e],i=r.kdArrayMap;a&&(t=a.markerShape,o=a.markerLabel,t&&t.dispose(),o&&o.dispose(),delete i[e],this._buildKdTree()),delete n[e]}},{key:"getElement",value:function(e){if(this.components.kDTree)return this.components.kDTree.getNeighbour(e)}}],[{key:"getMarkerRadiusLimits",value:function(e,t,o,r){var n=w(e,t);return r=parseFloat(r),o=parseFloat(o),isNaN(r)||isNaN(o)?isNaN(r)?isNaN(o)?{min:.02*n,max:.07*n}:{min:parseInt(o/10,10),max:o}:{min:r,max:10*r}:r<o?{min:r,max:o}:{min:o,max:r}}},{key:"_initializeMarkerItem",value:function(e,t,o){var r,n={},a=n.config;return a||(a=n.config={}),a.id=e,a.definition=t,a.application=o,a.hasValue=null,a.value=null,a.options=null,a.label=null,a.markerShape=null,a.markerLabel=null,a.drawOptions={shape:null,label:null},a.drawComplete=!1,r=n.config.options=(0,s.extend2)({},a.definition),a.dataEnabled?!isNaN(r.value)&&""!==r.value&&(n.value=parseFloat(r.value),n.hasValue=!0):a.applyAll?a.options=(0,s.extend2)(r,a.application):o&&(a.options=(0,s.extend2)(r,a.application)),n}}]),t}();t.default=E},469:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}();var n=function(e,t,o,r,n){var a=Math.pow;return a(o-e,2)+a(r-t,2)<=a(n,2)},a=Math.PI,i=Math.cos,l=Math.sin,s=Math.max,c=Math.min,u=a/180,d=function(e,t,o,r,n,a){var i,l,s;return i=(r-t)*(n-o),l=(o-e)*(a-r),isNaN(i)&&(i=0),isNaN(l)&&(l=0),0===(s=i-l)?0:0<s?1:2},h=function(e,t,o,r,n,a){return!!(o<=s(e,n)&&o>=c(e,n)&&r<=s(t,a)&&r>=c(t,a))},g=function(e,t,o,r,n,a,i,l){var s=d(e,t,o,r,n,a),c=d(e,t,o,r,i,l),u=d(n,a,i,l,e,t),g=d(n,a,i,l,o,r);return!!(s!==c&&u!==g||0===s&&h(e,t,n,a,o,r)||0===c&&h(e,t,i,l,o,r)||0===u&&h(n,a,e,t,i,l)||0===g&&h(n,a,o,r,i,l))},p=function(e,t,o,r,s,c,p){var f,m,v,b,y,k,C,x=0,w=!1;if(n(e,t,o,r,s)&&3<=c){for(m=void 0===p?.5*a:function(e){return e%360*u}(p),C=2*a/c,v=o+s*i(-m),k=r+s*l(-m),f=0;f<c;f++){if(b=o+s*i(-(m+=C)),y=r+s*l(-m),g(v,k,b,y,e,t,1/0,t)){if(0===d(v,k,e,t,b,y))return h(v,k,e,t,b,y);x++}v=b,k=y}w=0!=x%2}return w},f=function(e,t){return!e||e&&t&&t.i>e.i?t:e};var m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);this.configure(t)}return r(e,[{key:"configure",value:function(e){var t=this;t.validatorFn=e?t.shapeValidator():t.defaultValidator()}},{key:"defaultValidator",value:function(){var e=Math.pow,t=this;return function(o){var r=t.mousePoint;return!!(o&&1>=e((o.x-r.x)/t.xLimit,2)+e((o.y-r.y)/t.yLimit,2))}}},{key:"shapeValidator",value:function(){var e=this;return function(t){var o,r,a,i,l,s,c,u,d,h=e.mousePoint,g=t&&t.shapeInfo,f=!1,m=h.x,v=h.y;return"circle"===(o=g&&g.type)?(a=g.radius,f=n(m,v,t.x,t.y,a)):"arc"===o?(r=g.innerradius,a=g.radius,f=!n(m,v,t.x,t.y,r)&&n(m,v,t.x,t.y,a)):"polygon"===o?(a=g.radius,l=g.startAngle,i=g.sides,f=p(m,v,t.x,t.y,a,i,l)):"rect"===o||"rectangle"===o?(s=t.x,u=t.y,c=s+(g.width||0),d=u+(g.height||0),f=m>=s&&m<=c&&v>=u&&v<=d):"default"===o&&(f=!1),f}}},{key:"buildKdTree",value:function(e){return this.kdTree=function(e){function t(e,t,o){var r=e[t];e[t]=e[o],e[o]=r}var o,r,n,a=e&&e[0]&&e[0].r||5,i=Math.max,l=Math.floor,s=Math.sqrt,c=Math.min,u=Math.log,d=Math.exp,h=Math.pow;for(r=function(e,o,n,a){for(var h,g,p,f,m,v,b,y,k,C;a>n;){for(600<a-n&&(g=o-n+1,p=u(h=a-n+1),f=.5*d(2*p/3),m=.5*s(p*f*(h-f)/h)*(0>g-h/2?-1:1),v=i(n,l(o-g*f/h+m)),b=c(a,l(o+(h-g)*f/h+m)),r(e,o,v,b)),y=e[o],k=n,C=a,t(e,n,o),e[a].x>y.x&&t(e,n,a);k<C;){for(t(e,k,C),k++,C--;e[k].x<y.x;)k++;for(;e[C].x>y.x;)C--}e[n].x===y.x?t(e,n,C):t(e,++C,a),C<=o&&(n=C+1),o<=C&&(a=C-1)}},n=function(e,o,r,a){for(var h,g,p,f,m,v,b,y,k,C;a>r;){for(600<a-r&&(g=o-r+1,p=u(h=a-r+1),f=.5*d(2*p/3),m=.5*s(p*f*(h-f)/h)*(0>g-h/2?-1:1),v=i(r,l(o-g*f/h+m)),b=c(a,l(o+(h-g)*f/h+m)),n(e,o,v,b)),y=e[o],k=r,C=a,t(e,r,o),e[a].y>y.y&&t(e,r,a);k<C;){for(t(e,k,C),k++,C--;e[k].y<y.y;)k++;for(;e[C].y>y.y;)C--}e[r].y===y.y?t(e,r,C):t(e,++C,a),C<=o&&(r=C+1),o<=C&&(a=C-1)}},o=(e=e||[]).length;o--;)e[o].r>a&&(a=e[o].r),e[o].i=o,e[o].x=+e[o].x,e[o].y=+e[o].y;return{tree:0===e.length?{}:function e(t,o,a,i){var l,s={},c=i?"y":"x";return o===a?(s.point=t[o],s):1==a-o?(t[o][c]>t[a][c]?(s.point=t[o],s.left={point:t[a]}):(s.point=t[a],s.left={point:t[o]}),s):(l=o+a>>1,i?n(t,l,o,a):r(t,l,o,a),s.point=t[l],s.left=e(t,o,l-1,!i),s.right=e(t,l+1,a,!i),s)}(e,0,e.length-1,!1),search:function(e,t,o,r){function n(e,t,o,r){return s(h(e-o,2)+h(t-r,2))}function i(r,a){return"circle"===o?n(r,a,e,t)<=m:r>=m&&r<=v&&a>=b&&a<=y}function l(e,t,o){return e>=t&&e<=o}function c(o){var r=l(e,o.x1,o.x2)&&l(t,o.y1,o.y2),a=n(e,t,o.point.x,o.point.y);return d?void(r?k?o.point.i>d.point.i&&(d=o,k=r,C=a):(d=o,k=r,C=a):!k&&a<C&&(d=o,k=r,C=a)):(d=o,k=r,void(C=a))}function u(r,n){"circle"===o?m=r:(m=e-r||0,v=e+r||0,b=t-n||0,y=t+n||0)}var d,g,p,f=this.tree,m=e-a,v=e+a,b=t-a,y=t+a,k=!1,C=0;return r=r||{},p=function(e){e&&e.point&&(u(r.rx||e.point.r,r.ry||e.point.r),i(e.point.x,e.point.y)&&c(e),b<=e.point.y&&g(e.left),y>=e.point.y&&g(e.right))},(g=function(e){e&&e.point&&(u(r.rx||e.point.r,r.ry||e.point.r),i(e.point.x,e.point.y)&&c(e),m<=e.point.x&&p(e.left),v>=e.point.x&&p(e.right))})(f),d&&d.point||d}}}(e),this.tree=this.kdTree.tree,this}},{key:"getNeighbour",value:function(e,t,o){var r=this,n=r.tree,a={x1:e.x-r.xLimit,x2:e.x+r.xLimit,y1:e.y-r.yLimit,y2:e.y+r.yLimit},i=r.validatorFn;return r.mousePoint=e,t?this.kdTree&&this.kdTree.search(e.x,e.y,o,e.options):n?r._searchBtwnLimit(a,n,!0,i):void 0}},{key:"_searchBtwnLimit",value:function(e,t,o,r){var n,a,i=o?"x":"y",l=o?e.x1:e.y1,s=o?e.x2:e.y2;if(void 0!==(n=t&&t.point&&t.point[i]))return r(t.point)&&(a=t.point),n>=l&&t.left&&(a=f(a,this._searchBtwnLimit(e,t.left,!o,r))),n<=s&&t.right&&(a=f(a,this._searchBtwnLimit(e,t.right,!o,r))),a}},{key:"_setSearchLimit",value:function(e,t){this.xLimit=e,this.yLimit=t}}]),e}();m.prototype.constructor=m,t.default=m},470:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),n=s(o(3)),a=o(0),i=o(5),l=s(o(461));function s(e){return e&&e.__esModule?e:{default:e}}(0,i.addDep)({name:"mapsAnimation",type:"animationRule",extension:l.default});var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n.default),r(t,[{key:"getType",value:function(){return"group"}},{key:"getName",value:function(){return"mapGroup"}},{key:"configure",value:function(){this._mapChildren(function(e){e.configure&&e.configure()})}},{key:"createContainer",value:function(){var e,t=this,o=t.getLinkedParent(),r=t.getFromEnv("animationManager");e=o.getChildContainer().plotGroup,t.getChildContainer("plotShadow")||t.addChildContainer("plotShadow",r.setAnimation({el:"group",attr:{name:"manager-plot-shadow",opacity:1},container:e,component:t,label:"group"})),t.getChildContainer("plot")||t.addChildContainer("plot",r.setAnimation({el:"group",attr:{name:"manager-plot",opacity:1},container:e,component:t,label:"group"}))}},{key:"_transformGroup",value:function(){var e=this,t=this.getFromEnv("chart"),o=t.getFromEnv("chartInstance"),r=e.getFromEnv("animationManager"),n=t.jsonData,i=e.getChildContainer("plot"),l=e.getChildContainer("plotShadow"),s=t.config.scalingParams;i.hide(),l.hide(),t.config.entitiesReady=!1,o.addEventListener("internal.mapdrawingcomplete",function(t){t.detachHandler(),a.hasSVG&&(o.args.link&&o.args.clickedEntityBox&&n.chart.linkedcharttransition,i&&r.setAnimation({el:i,attr:{transform:s.transformStr},component:e,label:"group"}),l&&r.setAnimation({el:l,attr:{transform:s.transformStr},component:e,label:"group"})),i.show(),l.show()}),t.checkComplete()}},{key:"draw",value:function(){this.createContainer(),this._transformGroup()}},{key:"getDataLimits",value:function(e){var t=void 0,o=this,r=1/0,n=-1/0,a=0,i=function(e){n=Math.max(n,e.max),r=Math.min(r,e.min)};return o._mapChildren(function(o){return o.getState("removed")||!1===o.getState("visible")?void(e&&(t=o.getDataLimits(e),i(t))):(a++,t=o.getDataLimits(e),void i(t))}),a?o.setState("visible",!0):o.setState("visible",!1),this.config.range||(this.config.range={},this.config.range.min=this.config.dataMin,this.config.range.max=this.config.dataMax),{max:n,min:r}}}]),t}();t.default=c},471:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){!function(e){var t=e.getChildren("colorManager");e.getFromEnv("dataSource").colorrange?t?(e.addToEnv("colorManager",t[0]),t[0].configure()):(t=new r.default,e.attachChild(t,"colorManager"),e.addToEnv("colorManager",t),t.configure()):(t&&(t[0].config.legendItemIds=[]),e.deleteFromEnv("colorManager"))}(e)};var r=function(e){return e&&e.__esModule?e:{default:e}}(o(472))},472:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),n=c(o(3)),a=c(o(473)),i=c(o(475)),l=o(0),s=o(4);function c(e){return e&&e.__esModule?e:{default:e}}function u(e){return(0,s.getValidColor)(e||h)||h}var d="rgba(192,192,192,"+(l.isIE?.002:1e-6)+")",h="#000000",g=function(){var e,t={legendCarpetConf:{spreadFactor:.85,allowDrag:!1,captionAlignment:"center",padding:{v:3,h:3},style:{fill:"#e4d9c1",stroke:"#c4b89d"}},legendCaptionConf:{spreadFactor:.2,padding:{v:2,h:2},style:{fill:"#786B50",fontFamily:"sans-serif",fontSize:"12px",fontWeight:"bold",fontStyle:"normal"},bound:{style:{stroke:"none"}}},legendBodyConf:{spreadFactor:.8,padding:{v:2,h:2},bound:{style:{stroke:"none"}}}};return t.legendAxisConf={legendAxisHeight:11,spreadFactor:.4,padding:{v:1,h:1},style:{stroke:"none","stroke-opacity":0,"stroke-width":1},line:{grooveLength:3,offset:8,style:{stroke:"rgba(255, 255, 255, 0.65)","stroke-width":1.5}},shadow:{style:{stroke:"none",fill:(0,l.toRaphaelColor)({FCcolor:{alpha:"25,0,0",angle:360,color:"000000,FFFFFF,FFFFFF",ratio:"0,30,40"}})}},bound:{style:{stroke:"none"}}},t.sliderGroupConf={showTooltip:1,outerCircle:{rFactor:1.4,style:{fill:d,stroke:"#757575","stroke-width":3}},innerCircle:{rFactor:.65,style:{fill:d,stroke:"#FFFFFF"}}},t.axisTextItemConf={spreadFactor:.3,padding:{v:1,h:1},style:{fill:"#786B50",fontFamily:"sans-serif",fontSize:"12px",fontWeight:"normal",fontStyle:"normal"}},{init:function(t){e=t.chart},legacyDataParser:function(t,o){var r,n,a,i,c,d,h,g,p,f,m,v,b=Math.max,y=Math.min,k={},C=e.getFromEnv("number-formatter"),x=e.getFromEnv("dataSource"),w=x.dataset,F=x.data;if(o=o||{},!t)return!1;for("maps"!==e.defaultDatasetType||void 0!==o.min&&void 0!==o.max?"HeatMap"===e.getName()&&(void 0===o.min||void 0===o.max)&&(o={min:1/0,max:-1/0},w.forEach(function(e){e.data&&e.data.forEach(function(e){o.min=y(o.min,(0,l.pluckNumber)(e.value,o.min)),o.max=b(o.max,(0,l.pluckNumber)(e.value,o.max))})})):(o={min:1/0,max:-1/0},F&&F.forEach(function(e){o.min=y(o.min,(0,l.pluckNumber)(e.value,o.min)),o.max=b(o.max,(0,l.pluckNumber)(e.value,o.min))})),k.mapByPercent=m=!!(0,l.pluckNumber)(t.mapbypercent,0),r=t.color||[],void 0===t.minvalue&&(t.minvalue=void 0===o.min?0:m?0:o.min),void 0===t.maxvalue&&(t.maxvalue=void 0===o.max?100:m?100:o.max),(t.maxvalue===t.minvalue||o.min===1/0||o.max===-1/0)&&(t.minvalue=0,t.maxvalue=100),v=!1,c=0,h=r.length;c<h;c++)if(r[c].maxvalue){v=!0;break}for(v||(r=[]),a=t.code,g=k.colorRange=[],k.gradient=!!(0,l.pluckNumber)(t.gradient,1),r.length?a=u(a):(a?(i=u(a),a=u()):i=function(e){return(0,s.getLightColor)(e,1)}(a=u()),r.push({code:i,maxvalue:t.maxvalue,label:void 0})),function(t){var o,r,n,a=e.getFromEnv("number-formatter");for(o=0,r=t.length;o<r;o++)(n=t[o].maxvalue)&&(t[o].maxvalue=a.getCleanValue(n))}(r),r=r.sort(function(e,t){return e.maxvalue-t.maxvalue}),p=f=t.minvalue&&C.getCleanValue(t.minvalue),f=(void 0!==p||null!==p)&&(m?p+"%":C.legendValue(p)),g.push({code:(0,l.dehashify)(a),value:p,displayValue:f,label:t.startlabel}),c=0,h=r.length;c<h;c++)d=u((n=r[c]).code||n.color),p=f=n.maxvalue,!isNaN(parseInt(p,10))&&(f=(void 0!==p||null!==p)&&(m?p+"%":C.legendValue(p)),g.push({code:(0,l.dehashify)(d),value:p,displayValue:f,label:n.label||n.displayvalue}));return g[g.length-1].label=t.endlabel||n.label,k},getDefaultConf:function(e){return t[e]}}}(),p=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))).datasource={},e.config.legendItemIds=[],e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n.default),r(t,[{key:"configure",value:function(){var e,t,o=void 0,r=this,n=this.getFromEnv("chart"),s="maps"===n.defaultDatasetType,c="TreeMap"===n.getName(),u=this.getFromEnv("dataSource").chart.mapbycategory,d=n.getFromEnv("number-formatter"),h=n.config.showLegend,p=n.getChildren("colorRange")&&n.getChildren("colorRange")[0];n.addToEnv("colorManager",r),r.datasource=n.getFromEnv("dataSource"),e=r.datasource.colorrange,p&&p.remove({instant:!0}),h||(r.config.legendItemIds=[]),"gradient"===(t=s?e.gradient&&+e.gradient?"gradient":e.color?"icon":"none":c?"gradient":e.gradient&&"0"!=e.gradient&&!+u?"gradient":"icon")?(g.init({chart:n}),o=g.legacyDataParser(e),(0,l.componentFactory)(n,i.default,"colorRange",1,[o]),p=n.getChildren("colorRange")[0],n.addToEnv("colorRange",p),o||(p._dontPlot=!0),r.config.legendItemIds=[],r._configureGradientLegend(p)):"icon"===t?((0,l.componentFactory)(n,a.default,"colorRange",1,[{colorRange:e,sortLegend:0,mapByCategory:(0,l.pluckNumber)(u,0),defaultColor:"cccccc",numberFormatter:d}]),n.addToEnv("colorRange",n.getChildren("colorRange")[0]),h&&r._addLegendItems()):"none"===t&&(n.deleteFromEnv("colorManager"),r.config.legendItemIds=[])}},{key:"_configureGradientLegend",value:function(e){var t=this,o=t.getFromEnv("chart").getFromEnv("gLegend");o&&(o.setColorRange(e),t.addExtEventListener("rangeUpdated",function(e,o){t.fireEvent("legendUpdate",{"original-event":e,maxMinArray:o,component:"gradientlegend"})},o))}},{key:"_addLegendItems",value:function(){var e=void 0,t=void 0,o=void 0,r=void 0,n=void 0,a=this,i=a.config,c=a.getFromEnv("chart"),u=c.getChildren("legend")[0],d=c.getFromEnv("colorRange").colorArr,h=d.length;for(r=0;r<h;r++)n={label:(0,l.pluck)(d[r].label,d[r].displayvalue),datasetObj:d[r],index:r},t=(0,s.getLightColor)(d[r].code,40),e={FCcolor:{color:d[r].code+","+d[r].code+","+t,ratio:"0,70,30",angle:270,alpha:"100,100,100"}},(o=u.getItem(i.legendItemIds[r]))||(i.legendItemIds.push(u.createItem(a)),(o=u.getItem(i.legendItemIds[r])).addEventListener("click",o.itemClickFn)),o.removeLegendState("hidden"),d[r].legendItemId=o&&o.getId(),o.configure(n),o.setStateCosmetics("default",{symbol:{fill:(0,l.toRaphaelColor)(e),rawFillColor:d[r].code}});for(r=h;r<i.legendItemIds.length;r++)u.disposeItem(i.legendItemIds[r]);i.legendItemIds.splice(h)}},{key:"legendInteractivity",value:function(e){var t=this.getFromEnv("colorRange").colorArr[e.config.index];this.fireEvent("legendUpdate",{legendItem:e,colorObj:t,component:"legend"})}},{key:"getColor",value:function(e){var t=this,o=t.datasource.colorrange;return!+t.datasource.chart.mapbycategory&&+o.gradient?{code:t.getColorByValue(e)}:t.getColorObj(e)}},{key:"getValueRatio",value:function(){return this.getFromEnv("colorRange").getValueRatio()}},{key:"getCumulativeValueRatio",value:function(){return this.getFromEnv("colorRange").getCumulativeValueRatio()}},{key:"getBoxFill",value:function(e){return this.getFromEnv("colorRange").getBoxFill(e)}},{key:"getColorByValue",value:function(e){return this.getFromEnv("colorRange").getColorByValue(e)}},{key:"getColorObj",value:function(e){return this.getFromEnv("colorRange").getColorObj(e)}}]),t}();t.default=p},473:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),n=o(0),a=o(474),i=function(e){return e&&e.__esModule?e:{default:e}}(o(3));var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),o=e;return o.mapByCategory=!1,o.colorArr=[],o.noValidRange=!0,o.sortLegend=!1,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"__setDefaultConfig",value:function(){(function e(t,o,r){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,o);if(void 0===n){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,o,r)}if("value"in n)return n.value;var i=n.get;return void 0!==i?i.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"__setDefaultConfig",this).call(this),this.config.defaultObj={code:"CCCCCC",alpha:"100"}}},{key:"getType",value:function(){return"colorComponent"}},{key:"getName",value:function(){return"colorBucket"}},{key:"configure",value:function(e){if(e){var t=void 0,o=void 0,r=void 0,a=void 0,i=void 0,l=void 0,s=void 0,c=void 0,u=void 0,d=void 0,h=void 0,g=this,p=g.mapByCategory,f=e.numberFormatter,m=e.colorRange||{},v=(0,n.extend2)([],m.color),b=this.getLinkedParent(),y=g.getFromEnv("dataSource"),k=Math.min(Math.max((0,n.pluckNumber)(y.chart.palette,0)-1,0),4),C=b.defaultPaletteOptions&&b.defaultPaletteOptions.paletteColors[k],x=(0,n.pluckNumber)(f.getCleanValue(m.maxvalue),1/0),w=(0,n.pluckNumber)(f.getCleanValue(m.minvalue),-1/0),F=g.colorArr;if(void 0!==e.mapByCategory&&(p=g.mapByCategory=!!+e.mapByCategory),(v=p?v.filter(function(e){return e.code||e.color}):v.filter(function(e){return e.minvalue||e.maxvalue})).forEach(function(e){e.minvalue&&e.maxvalue&&+e.maxvalue<+e.minvalue&&(c=e.maxvalue,e.maxvalue=e.minvalue,e.minvalue=c),e.minvalue?e.maxvalue?(d=f.getCleanValue(e.minvalue),u=f.getCleanValue(e.maxvalue),e.rangeLabel=f.dataLabels(d)+"-"+f.dataLabels(u)):(d=f.getCleanValue(e.minvalue),e.maxvalue=u=x,e.rangeLabel=u===1/0?">"+f.dataLabels(d):f.dataLabels(d)+"-"+f.dataLabels(u)):(e.minvalue=d=w,u=f.getCleanValue(e.maxvalue),e.rangeLabel=d===-1/0?"<"+f.dataLabels(u):f.dataLabels(d)+"-"+f.dataLabels(u))}),v.sort(function(e,t){return+e.minvalue==+t.minvalue?e.maxvalue-t.maxvalue:e.minvalue-t.minvalue}),v&&(t=v.length)){for(F.length=0,o=0;o<t;o+=1)s=v[o],r=(0,n.pluck)(s.color,s.code,C&&C[o]),a=(0,n.pluck)(s.alpha),l=(0,n.pluck)(s.bordercolor),i=(0,n.pluck)(s.borderalpha,100),u=(0,n.pluckNumber)(s.maxvalue),d=(0,n.pluckNumber)(s.minvalue),h=(0,n.pluck)(s.label,s.displayvalue,s.rangeLabel),(r&&u>=d||p&&h)&&F.push({code:r,alpha:a||"100",oriAlpha:a,maxvalue:u,minvalue:d,label:(0,n.parseUnsafeString)(h),labelId:h.toLowerCase(),bordercolor:l,borderAlpha:i,name:s.name});g.sortedColorArr=g.colorArr.slice(0)}else g.noValidRange=!0,g.colorArr=[],g.sortedColorArr=[]}}},{key:"getColorObj",value:function(e){if(void 0===e)return{outOfRange:!0};var t=void 0,o=this,r=o.sortedColorArr,i=o.gradient?1:0,l=r[i];if(o.mapByCategory){for(e=(0,n.parseUnsafeString)(e).toLowerCase()||e.toString().toLowerCase();l;){if(l.labelId===e||l.maxvalue>=e&&l.minvalue<=e)return{code:l.code,alpha:l.alpha||"100",oriAlpha:l.oriAlpha,seriesIndex:i,legendItemId:l.legendItemId};l=r[i+=1]}return{outOfRange:!0}}if(o.gradient){if(o.scaleMin<=e&&o.scaleMax>=e){for(;l&&l.maxvalue<e;)l=r[i+=1];return t=(e-l.minvalue)/l.range,{code:function(e,t,o){var r=e[0],n=e[1],i=e[2],l=r+(t[0]-r)*o,s=n+(t[1]-n)*o,c=i+(t[2]-i)*o;return{hex:(a.COLOR_BLACK+(l<<16|s<<8|c).toString(16)).slice(-6),rgb:[l,s,c]}}(r[i-1].codeRGB,l.codeRGB,t).hex}}return{outOfRange:!0}}for(;l;){if(e<l.minvalue)return 0==i?{code:l.code,alpha:l.alpha||"100",oriAlpha:l.oriAlpha,seriesIndex:i,name:l.name,label:l.label,outOfRange:!0,bordercolor:l.bordercolor,borderalpha:l.borderAlpha}:{code:r[i-1].code,alpha:r[i-1].alpha||"100",oriAlpha:r[i-1].oriAlpha,seriesIndex:i,name:r[i-1].name,label:r[i-1].label,outOfRange:!0,bordercolor:r[i-1].bordercolor,borderalpha:r[i-1].borderAlpha};if(e>l.maxvalue&&i==r.length-1)return{code:l.code,alpha:l.alpha||"100",oriAlpha:l.oriAlpha,seriesIndex:i,name:l.name,label:l.label,outOfRange:!0,bordercolor:l.bordercolor,borderalpha:l.borderAlpha};if(l.maxvalue>=e&&l.minvalue<=e)return{code:l.code,alpha:l.alpha||"100",oriAlpha:l.oriAlpha,seriesIndex:i,name:l.name,label:l.label,bordercolor:l.bordercolor,borderalpha:l.borderAlpha};l=r[i+=1]}return r.length?void 0:{outOfRange:!0}}},{key:"getColorRangeArr",value:function(e,t){var o,r,a,i,l,s,c,u,d=this.colorArr,h=[];if(!this.defaultAsigned&&(e>t&&(o=e,e=t,t=o),e<t&&(i=this.getColorObj(e),s=this.getColorObj(t),i&&s))){for(l=e,r=i.seriesIndex,a=s.seriesIndex;r<=a;r+=1)(c=(0,n.extend2)({},d[r])).minvalue!==l&&(c.minvalue=l),h.push(c),u=c,l=c.maxvalue;u&&(u.maxvalue=t)}return h}}]),t}();t.default=l},474:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HUNDREDSTRING="100",t.BLANK="",t.COLOR_BLACK="#000000"},475:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),n=function(e){return e&&e.__esModule?e:{default:e}}(o(3)),a=o(0),i=o(4);var l=function(e,t,o){var r,n,a=Math.round,l=e.value,s=e.code,c=(0,i.HEXtoRGB)(s),u=t.value,d=t.code,h=(0,i.HEXtoRGB)(d);return r=u-l,n=[a(c[0]+(h[0]-c[0])/r*(o-l)),a(c[1]+(h[1]-c[1])/r*(o-l)),a(c[2]+(h[2]-c[2])/r*(o-l))],(0,i.RGBtoHex)(n)},s=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))).colorRange={},e.valueRatio={},e.data={},e.mapByPercent=void 0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n.default),r(t,[{key:"getType",value:function(){return"colorComponent"}},{key:"getName",value:function(){return"gradientColorRange"}},{key:"configure",value:function(e){if(e){var t,o,r=void 0,n=this;for(n.data=e,n.appender="",o=n.colorRange=e.colorRange.sort(function(e,t){return e.value-t.value}),n.valueRatio=void 0,n.values=[],r=0,t=o.length;r<t;r++)n.values.push(o[r].value)}}},{key:"getValueRatio",value:function(){var e,t,o=this.colorRange,r=o.length,n=this.valueRatio,a=o[r-1].value,i=o[0].value,l=0;if(n)return n;for(n=this.valueRatio=[],e=0;e<r;e++)t=(o[e].value-i)/(a-i),n.push(100*(t-l)),l=t;return n}},{key:"getCumulativeValueRatio",value:function(){var e,t,o=this.colorRange,r=o.length,n=o[0].value,a=o[r-1].value,i=[];for(t=0;t<r;t++)e=o[t],i.push((e.value-n)/(a-n)*100);return i}},{key:"getBoxFill",value:function(e){var t,o,r,n,i=this.colorRange,l=i.length,s=[];for(n=e?90:0,o=0;o<l;o++)t=i[o],s.push(t.code);return r={FCcolor:{alpha:"100,100,100",angle:n,color:s.join(","),ratio:this.getValueRatio().join(",")}},(0,a.toRaphaelColor)(r)}},{key:"getColorByValue",value:function(e){var t,o,r,n,a=this.values,i=this.colorRange;if(void 0!==e&&null!==e){for(o=0,t=a.length;o<t;o++){if(e===a[o]){n=i[o].code;break}if(!o&&e<a[o]){r=!0;break}if(o===t-1&&e>a[o]){r=!0;break}if(e>a[o]&&e<a[o+1]){n=l(i[o],i[o+1],e);break}}return r?void 0:n}}}]),t}();t.default=s},476:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){!function(e){var t=void 0,o=e.getFromEnv("dataSource").colorrange,i=e.getFromEnv("dataSource").chart.mapbycategory,l="maps"===e.defaultDatasetType,s="TreeMap"===e.getName(),c=e.getFromEnv("legend"),u=e.getFromEnv("gLegend");"gradient"==(t=o&&e.config.showLegend?l?o.gradient&&+o.gradient?"gradient":o.color?"icon":"none":s?o.gradient&&"0"!=o.gradient?"gradient":"none":o.gradient&&"0"!=o.gradient&&!+i?"gradient":"icon":"none")?(e.deleteFromEnv("legend"),c&&c.remove(),(0,r.componentFactory)(e,n.default,"gLegend",1),(u=e.getChildren("gLegend")[0]).configure(),e.addToEnv("gLegend",u)):"icon"===t?(e.deleteFromEnv("gLegend"),u&&u.remove(),(0,r.componentFactory)(e,a.default,"legend",1,{showLegend:!0}),(c=e.getChildren("legend")[0]).configure(),e.addToEnv("legend",c)):"none"===t&&(e.deleteFromEnv("gLegend"),e.deleteFromEnv("legend"),u&&u.remove(),c&&c.remove())}(e)};var r=o(0),n=i(o(477)),a=i(o(144));function i(e){return e&&e.__esModule?e:{default:e}}},477:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=o(0),i=o(4),l=function(e){return e&&e.__esModule?e:{default:e}}(o(3));function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var d=void 0,h=void 0,g=void 0,p=void 0,f={},m="rgba(192,192,192,"+(a.isIE?.002:1e-6)+")",v=!1,b=!0,y="#000000",k={}.hasOwnProperty,C="M",x="L";function w(e,t){return function e(t,o){var r,a;for(a in t)k.call(t,a)&&(r=t[a],o[a]===d?o[a]=r:"object"==(void 0===r?"undefined":n(r))&&null!==r&&e(r,o[a]))}(e,t),t}function F(e){return(0,i.getValidColor)(e||y)||y}function _(e){var t,o=e.fontSize+"";return o?(t=o.replace(/(\d+)(px)*/,"$1px"),e.fontSize=t,e):e}function L(e){return!(e!==d&&void 0!==e&&null!==e&&!isNaN(e))}f.CAPTION="CAPTION",f.LEGEND_BODY="LEGEND_BODY",f.AXIS_LABEL="LEGEND_LABEL",f.LEGEND_AXIS="LEGEND_AXIS",f.RANGE="RANGE",f.AXIS_VALUE="AXIS_VALUE",h=function(){var e,t={legendCarpetConf:{spreadFactor:.85,allowDrag:!1,captionAlignment:"center",padding:{v:3,h:3},style:{fill:"#e4d9c1",stroke:"#c4b89d"}},legendCaptionConf:{spreadFactor:.2,padding:{v:2,h:2},style:{fill:"#786B50",fontFamily:"sans-serif",fontSize:"12px",fontWeight:"bold",fontStyle:"normal"},bound:{style:{stroke:"none"}}},legendBodyConf:{spreadFactor:.8,padding:{v:2,h:2},bound:{style:{stroke:"none"}}}};return t.legendAxisConf={legendAxisHeight:11,spreadFactor:.4,padding:{v:1,h:1},style:{stroke:"none","stroke-opacity":0,"stroke-width":1},line:{grooveLength:3,offset:8,style:{stroke:"rgba(255, 255, 255, 0.65)","stroke-width":1.5}},shadow:{style:{stroke:"none",fill:(0,a.toRaphaelColor)({FCcolor:{alpha:"25,0,0",angle:360,color:"000000,FFFFFF,FFFFFF",ratio:"0,30,40"}})}},bound:{style:{stroke:"none"}}},t.sliderGroupConf={showTooltip:1,outerCircle:{rFactor:1.4,style:{fill:m,stroke:"#757575","stroke-width":3}},innerCircle:{rFactor:.65,style:{fill:m,stroke:"#FFFFFF"}}},t.axisTextItemConf={spreadFactor:.3,padding:{v:1,h:1},style:{fill:"#786B50",fontFamily:"sans-serif",fontSize:"12px",fontWeight:"normal",fontStyle:"normal"}},{init:function(t){e=t.chart},legacyDataParser:function(t,o){var r,n,l,s,c,u,h,g,p,f,m,v,b={},y=e.getFromEnv("number-formatter");if(!t)return!1;for(b.mapByPercent=m=!!(0,a.pluckNumber)(t.mapbypercent,0),r=t.color||[],t.minvalue===d&&(t.minvalue=o.min===d?0:m?0:o.min),t.maxvalue===d&&(t.maxvalue=o.max===d?100:m?100:o.max),v=!1,c=0,h=r.length;c<h;c++)if(r[c].maxvalue){v=!0;break}for(v||(r=[]),l=t.code,g=b.colorRange=[],b.gradient=!!(0,a.pluckNumber)(t.gradient,1),r.length?l=F(l):(l?(s=F(l),l=F()):s=function(e){return(0,i.getLightColor)(e,1)}(l=F()),r.push({code:s,maxvalue:t.maxvalue,label:d})),function(t){var o,r,n,a=e.getFromEnv("number-formatter");for(o=0,r=t.length;o<r;o++)(n=t[o].maxvalue)&&(t[o].maxvalue=a.getCleanValue(n))}(r),r=r.sort(function(e,t){return e.maxvalue-t.maxvalue}),p=f=t.minvalue&&y.getCleanValue(t.minvalue),f=(p!==d||null!==p)&&(m?p+"%":y.legendValue(p)),g.push({code:(0,a.dehashify)(l),value:p,displayValue:f,label:t.startlabel}),c=0,h=r.length;c<h;c++)u=F((n=r[c]).code||n.color),p=f=n.maxvalue,!isNaN(parseInt(p,10))&&(f=(p!==d||null!==p)&&(m?p+"%":y.legendValue(p)),g.push({code:(0,a.dehashify)(u),value:p,displayValue:f,label:n.label||n.displayvalue}));return g[g.length-1].label=t.endlabel||n.label,b},getDefaultConf:function(e){return t[e]}}}();var A=function(e){function t(){var e;return s(this,t),e=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),p=e,e.enabled=!1,e.drawOptions={},e.components={},e}return u(t,l.default),r(t,[{key:"getType",value:function(){return"gradientLegend"}},{key:"getName",value:function(){return"gLegend"}}]),r(t,[{key:"setColorRange",value:function(e){var t=this.drawOptions.colorRange=e;t&&t._preparationGoneWrong&&(this._dontPlot=!0)}},{key:"configureAttributes",value:function(){var e,t,o,r,n,l,s,c,u,p,f=this,m=f.getFromEnv("chart"),v=f.getFromEnv("dataSource").chart,b=f.conf={},y=v.outcnvbasefont,k=v.outcnvbasefontsize,C=v.outcnvbasefontcolor,x=m.config.dataLabelStyle;h.init({chart:m}),f.data=f.getFromEnv("dataSource").colorrange,f._dontPlot||(f.drawOptions={smartLabel:f.getFromEnv("smartLabel"),gLegend:f},f._dontPlot=!1,f._recalculateLogicalSpace=!0,g=f.getFromEnv("toolTipController"),b.caption=(0,a.pluck)(v.legendcaption),b.legendPosition=(0,a.pluck)(v.legendposition,"bottom").toLowerCase(),b.showLegend=(0,a.pluckNumber)(v.showlegend,1),b.interactiveLegend=(0,a.pluckNumber)(v.interactivelegend,1),b.showLegendLabels=(0,a.pluckNumber)(v.showlegendlabels,1),e=v.legenditemfontcolor||C,t=v.legenditemfont||y,o=v.legenditemfontsize||k,r=(0,a.pluckNumber)(v.legenditemfontbold,0),n=v.legendcaptionfontcolor||C,l=v.legendcaptionfont||y,s=v.legendcaptionfontsize||k,c=(0,a.pluckNumber)(v.legendcaptionfontbold,1),p=(u=v.legendaxisbordercolor?(0,a.hashify)((0,a.dehashify)(v.legendaxisbordercolor)):d)?(0,a.pluckNumber)(v.legendaxisborderalpha,100)/100:d,b.axisTextItemConf={style:{fill:e?(0,i.convertColor)((0,a.pluck)(e)):x.color,fontFamily:t?(0,a.pluck)(t):x.fontFamily,fontSize:o?(0,a.pluckNumber)(o):x.fontSize.match(/\d+/)[0],fontWeight:r?"bold":x.fontWeight}},b.legendCaptionConf={style:{fill:n?(0,i.convertColor)((0,a.pluck)(n)):x.color,fontFamily:l?(0,a.pluck)(l):x.fontFamily,fontSize:s?(0,a.pluckNumber)(s):x.fontSize.match(/\d+/)[0],fontWeight:c?"bold":x.fontWeight,fontStyle:"normal"}},b.legendAxisConf={legendAxisHeight:11,style:{stroke:u,"stroke-opacity":p},line:{style:{stroke:(0,i.convertColor)((0,a.pluck)(v.legendscalelinecolor,"FFF8E9"),(0,a.pluckNumber)(v.legendscalelinealpha,100)),"stroke-width":(0,a.pluckNumber)(v.legendscalelinethickness)}}},b.sliderGroupConf={showTooltip:(0,a.pluckNumber)(v.showtooltip,1),outerCircle:{rFactor:(0,a.pluckNumber)(v.sliderdiameterfactor),style:{stroke:(0,i.convertColor)((0,a.pluck)(v.legendpointerbordercolor,"757575"),(0,a.pluckNumber)(v.legendpointerborderalpha,100))}},innerCircle:{rFactor:(0,a.pluckNumber)(v.sliderholediameterfactor),style:{stroke:(0,i.convertColor)((0,a.pluck)(v.legendpointercolor,"FFFFFF"),(0,a.pluckNumber)(v.legendpointeralpha,100))}}},b.legendCarpetConf={spreadFactor:(0,a.pluckNumber)(v.legendspreadfactor),allowDrag:!!(0,a.pluckNumber)(v.legendallowdrag,0),captionAlignment:(0,a.pluck)(v.legendcaptionalignment,"center"),style:{fill:(0,i.convertColor)((0,a.pluck)(v.legendbgcolor,"e4d9c1"),(0,a.pluckNumber)(v.legendbgalpha,100)),stroke:(0,i.convertColor)((0,a.pluck)(v.legendbordercolor,"c4b89d"),(0,a.pluckNumber)(v.legendborderalpha,100)),"stroke-width":(0,a.pluckNumber)(v.legendborderthickness,1)}})}},{key:"postConfigureInit",value:function(){var e,t,o,r,n,a,i,l,s,c,u,d=this,g=d.conf;d.elem={},g.interactiveLegend?(r=w(h.getDefaultConf("sliderGroupConf"),g.sliderGroupConf),this.sGroup?((o=d.elem.sGroup=this.sGroup).configure(r),d.elem.sGroup.gLegend=d):(this.sGroup=d.elem.sGroup=o=new R(r),o.configure(r),d.elem.sGroup.gLegend=d)):(this.sGroup&&this.sGroup.dispose(),this.sGroup&&delete this.sGroup),(r=w(h.getDefaultConf("legendCarpetConf"),g.legendCarpetConf)).legendPosition=g.legendPosition,u=h.getDefaultConf("legendBodyConf"),"bottom"===g.legendPosition?(d.drawOptions.refSideKey="canvasWidth",d.drawOptions.refOffsetKey="canvasLeft",n=w(h.getDefaultConf("axisTextItemConf"),g.axisTextItemConf),u.legendPosition="bottom",(c=w(h.getDefaultConf("legendAxisConf"),g.legendAxisConf)).legendPosition="bottom",n.legendPosition="bottom"):(d.drawOptions.refSideKey="canvasHeight",d.drawOptions.refOffsetKey="canvasTop",n=w(h.getDefaultConf("axisTextItemConf"),g.axisTextItemConf),u.legendPosition="right",(c=w(h.getDefaultConf("legendAxisConf"),g.legendAxisConf)).legendPosition="right",n.legendPosition="right"),Object.keys(this.components).length||(this.components.LegendCarpet=new E,this.components.LegendBody=new P,this.components.LegendAxis=new I,this.components.LegendValues=new M,g.showLegendLabels&&(this.components.LegendLabels=new N)),t=this.components.LegendAxis,l=this.components.LegendValues,e=this.components.LegendCarpet,a=this.components.LegendBody,g.showLegendLabels&&(i=this.components.LegendLabels),this.components.LegendCarpet.configure(r),this.components.LegendValues.configure(n),this.components.LegendAxis.configure(c),this.components.LegendBody.configure(d.drawOptions.colorRange,u,n),g.showLegendLabels&&i.configure(n),g.caption?(s=w(h.getDefaultConf("legendCaptionConf"),g.legendCaptionConf),this.componentCaption&&Object.keys(this.componentCaption).length?this.componentCaption.configure(g.caption,s):(this.componentCaption=new O).configure(g.caption,s),e.addCompositions(this.componentCaption,f.CAPTION)):(e.removeCompositions(f.CAPTION),this.componentCaption&&this.componentCaption.dispose(),delete this.componentCaption),o&&t.addCompositions(o,f.RANGE),i&&a.addCompositions(i,f.AXIS_LABEL),a.addCompositions(t,f.LEGEND_AXIS),a.addCompositions(l,f.AXIS_VALUE),e.addCompositions(a,f.LEGEND_BODY),d.elem.gl=new S(e)}},{key:"getValueRange",value:function(){var e,t,o=this.elem&&this.elem.sGroup,r=o.sliders,n=o.extremes;return e=r.false.currPos,t=n[1]-n[0]+r.true.currPos,[{min:o.getValueFormPixel(e),max:o.getValueFormPixel(t)}]}},{key:"_dispose",value:function(){var e=this;e.elem&&e.elem.gl&&e.elem.gl.dispose(),e.elem={},function e(t,o,r){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,o);if(void 0===n){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,o,r)}if("value"in n)return n.value;var i=n.get;return void 0!==i?i.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_dispose",this).call(this)}},{key:"getCalculatedLogicalSpace",value:function(){return this._logicalArea}},{key:"setCalculatedLogicalSpace",value:function(e){this._logicalArea=e}},{key:"getLogicalSpace",value:function(e){var t,o,r,n=this,a=n.conf,i={height:0,width:0},l=n.drawOptions,s=n.getFromEnv("chartConfig");return n._recalculateLogicalSpace?n._dontPlot?i:(n._recalculateLogicalSpace=!1,n.postConfigureInit(),a.showLegend?(o=l.refSideKey,r=l.refOffsetKey,n.drawOptions.refSide=s[o],n.drawOptions.refOffset=s[r],n.drawOptions.maxOtherSide=e||n.drawOptions.maxOtherSide,n.elem.gl&&(t=n.elem.gl.getLogicalSpace(n.drawOptions,!0),n.elem.gl&&n.setCalculatedLogicalSpace(t)),n.getCalculatedLogicalSpace()):i):(o=l.refSideKey,r=l.refOffsetKey,n.drawOptions.refSide=s[o],n.drawOptions.refOffset=s[r],n.drawOptions.maxOtherSide=e||n.drawOptions.maxOtherSide,t=n.elem.gl.getLogicalSpace(n.drawOptions,!0),n.setCalculatedLogicalSpace(t),n.getCalculatedLogicalSpace()||i)}},{key:"resetLegend",value:function(){var e;(e=this.elem&&this.elem.sGroup)&&e.reset()}},{key:"allocatePosition",value:function(){var e,t,o,r,n,a,i=this.getFromEnv("chart"),l=i.config,s=this.conf||{},c=s.legendPosition,u=l.canvasLeft,d=l.canvasTop,h=l.canvasWidth,g=l.canvasHeight,p=l.marginBottom,f=l.marginRight;i.config.gLegendEnabled&&(e=this.getCalculatedLogicalSpace(),o=s.width=e.width,r=s.height=e.height,"bottom"===c?(n=u+(0>(t=h-o)?0:t/2),a=l.height-e.height-p-(l.actionBarHeight||0)):(a=d+(0>(t=g-r)?0:t/2),n=l.width-e.width-f),s.xPos=n,s.yPos=a)}},{key:"draw",value:function(){var e=this.getFromEnv("chart"),t=e.getFromEnv("dataSource").colorrange,o=this.conf||{},r=e.hasGradientLegend;!e.config.gLegendEnabled||t&&r&&this.drawLegendComponent(o.xPos,o.yPos,{parentGroup:e.getContainer("parentgroup"),animationManager:e.getFromEnv("animationManager")})}},{key:"drawLegendComponent",value:function(e,t,o){var r,n=this,a=n.conf;return n._dontPlot?void 0:a.showLegend?(n.drawOptions.animationManager=o.animationManager,n.drawOptions.parentGroup=o.parentGroup,n.drawOptions.x=e,n.drawOptions.y=t,n.drawOptions.maxOtherSide=n.drawOptions.maxOtherSide||o.maxOtherSide,r=n.elem.gl.draw(n.drawOptions).getBBox(),a.xPos=r.x,a.yPos=r.y,a.height=r.height,a.width=r.width,void(n.enabled=!0)):void(n.enabled=!1)}}]),t}(),S=function(){function e(t){s(this,e),this.carpet=t}return r(e,[{key:"draw",value:function(e){return this.carpet.draw(e)}},{key:"getLogicalSpace",value:function(e,t){return this.carpet.getLogicalSpace(e,t)}},{key:"dispose",value:function(){this.carpet&&this.carpet.group&&this.carpet.group.remove()}}]),e}(),E=function(){function e(t){s(this,e),this.conf=t,this._id="GL_CARPET",this.compositionsByCategory={},this.node=d,this.group=d,this._lSpace=d,this.autoRecalculate=!1,this.groupName="fc-gradient-legend",this.moveInstructions={}}return r(e,[{key:"configure",value:function(e){this.conf=e}},{key:"getName",value:function(){return"LegendCarpet"}},{key:"getType",value:function(){return"legend"}},{key:"addCompositions",value:function(e,t){this.compositionsByCategory[t]=e}},{key:"removeCompositions",value:function(e){delete this.compositionsByCategory[e]}},{key:"getBoundingBox",value:function(e){var t,o,r=this.conf,n=r.spreadFactor,a=e.refSide,i=e.alignment,l=e.refOffset,s=e.x,c=e.y;return"bottom"===this.conf.legendPosition?(t=r.width=a*n,o=e.maxOtherSide,i&&(s===d||null===s)&&(s=(l+a)/2-t/2)):(o=r.height=a*n,t=e.maxOtherSide,i&&(c===d||null===c)&&(c=(l+a)/2-o/2)),{width:t,height:o,x:s,y:c}}},{key:"getPostCalcDecisionsH",value:function(e,t){var o,r=this.conf.padding,n=0;for(o in this.moveInstructions={},t)n+=t[o].height||0;e.height=n+2*r.v}},{key:"getLogicalSpace",value:function(e,t){var o,r,n,a,i,l=this._lSpace,s=["CAPTION","LEGEND_BODY"],c=this.conf.padding,u=this.compositionsByCategory,d=0,h={},g=0;if(l&&!t)return l.isImpure=!0,l;(L((l=this._lSpace=r=this.getBoundingBox(e)).x)||L(l.y)||L(l.height)||L(l.width))&&(this.autoRecalculate=!0),(n=w(r,{})).height-=2*c.v,n.width-=2*c.h,n.x+=c.h,n.y+=c.v;for(var p=0;p<s.length;p++)(o=u[s[p]])&&((i=w(n,{})).y+=d,d=n.height*o.conf.spreadFactor,i.height=d+g,a=o.getLogicalSpace(w(i,{}),e,t),g=i.height-a.height,h[s[p]]=a,d=a.height);return this.getPostCalcDecisions(r,h),this._lSpace=r,r}},{key:"setupDragging",value:function(){var e=this.group,t=0,o=0,r=0,n=0;e.css({cursor:"move"}),e.drag(function(a,i){t=a,o=i,e.attr({transform:"t"+(r+t)+","+(n+o)})},function(){r+=t,n+=o},a.stubFN)}},{key:"draw",value:function(e){var t,o,r,n=this.conf,a=["CAPTION","LEGEND_BODY"],i=this.compositionsByCategory,l=e.animationManager,s=e.parentGroup;this.getLogicalSpace(e,this.autoRecalculate),r=this._lSpace,this.group=t=l.setAnimation({el:this.group||"group",attr:{name:this.groupName},component:p,container:s,label:"carpetGroup"}),this.node=l.setAnimation({el:this.node||"rect",attr:r,css:n.style,component:p,container:t,label:"rect"});for(var c=0;c<a.length;c++)(o=i[a[c]])&&o.draw(n.captionAlignment,r,{animationManager:l,colorRange:e.colorRange,numberFormatter:e.numberFormatter,parentLayer:t,smartLabel:e.smartLabel,moveInstructions:this.moveInstructions[void 0],gLegend:e.gLegend});return n.allowDrag&&this.setupDragging(),this.node}},{key:"getPostCalcDecisions",value:function(e,t){return"bottom"===this.conf.legendPosition?this.getPostCalcDecisionsH(e,t):this.getPostCalcDecisionsV(e,t)}},{key:"getPostCalcDecisionsV",value:function(e,t){var o,r,n,a=this.conf.padding,i=Number.NEGATIVE_INFINITY,l=this.moveInstructions;for(r in this.getPostCalcDecisionsH(e,t),t)i=i<(o=t[r].width)?o:i;for(r in e.width=i+2*a.h,t)(n=i-(o=t[r].width))&&(l[r]="t"+n/2+",0")}}]),e}(),O=function(){function e(t,o){s(this,e),this.rawText=t,this.conf=o,this._id="GL_CAPTION",this.node=d,this.bound=d,this._lSpace=d,this.LegendCaption={},this.LegendCaption.LEFT={x:function(e,t){return t.x+e.width/2+2}},this.LegendCaption.RIGHT={x:function(e,t){return t.x+t.width-e.width/2-2}},this.LegendCaption.CENTER={x:function(){var e=arguments[1];return e.x+e.width/2}}}return r(e,[{key:"configure",value:function(e,t){this.rawText=e,this.conf=t}},{key:"getName",value:function(){return"LegendCaption"}},{key:"getType",value:function(){return"caption"}},{key:"getLogicalSpace",value:function(e,t,o){var r,n,a,i,l=this.conf.padding,s=this._lSpace,c=this.rawText,u=t.gLegend.getFromEnv("chartConfig");return s&&!o?(s.isImpure=!0,s):(s=this._lSpace={bound:{height:0,width:0},node:{logicArea:d,smartText:d}},r=t.smartLabel,c?((n=w(e,{})).height-=2*l.v,n.width-=2*l.h,n.x+=l.h,n.y+=l.v,r.useEllipsesOnOverflow(u.useEllipsesWhenOverflow),_(i=w(this.conf.style,{})),r.setStyle(this._metaStyle=i),a=r.getSmartText(c,n.width,n.height),n.height=a.height,n.width=a.width,e.height=a.height+2*l.v,e.width=a.width+2*l.h,s.node.smartText=a,s.node.logicArea=n,s.bound=e,e):s.bound)}},{key:"draw",value:function(){var e,t,o,r,n,a,i,l,s,c,u,d=this.conf,h=d.bound||{};return 3<=arguments.length?(i=arguments[0],l=arguments[1],s=arguments[2]):2<=arguments.length&&(i=arguments[0],s=arguments[1]),e=s.parentLayer,u=s.animationManager,this.group=t=u.setAnimation({el:this.group||"group",attr:{name:"legend-caption"},css:d.style,component:p,container:e}),this.getLogicalSpace(l,s),c=(n=this._lSpace).node,r=n.bound,this.bound=o=u.setAnimation({el:this.bound||"rect",attr:r,css:h.style,container:t,component:p}),a="string"==typeof i?this.LegendCaption[i.toUpperCase()].x(c.smartText,l||c.logicArea):i,this.node=u.setAnimation({el:this.node||"text",attr:{text:c.smartText.text,x:a,y:c.logicArea.y+c.smartText.height/2,lineHeight:this._metaStyle.lineHeight,fill:d.style.fill},container:t,component:p}),{group:t,bound:o,node:this.node}}},{key:"dispose",value:function(){this.group.remove(),this.bound.remove(),this.node.remove()}}]),e}(),P=function(){function e(t,o,r){s(this,e),this.colorRange=t,this.conf=o,this.childTextConf=r,this._id="GL_BODY",this.bound=d,this.group=d,this.compositionsByCategory={},this._lSpace=d,this.SC_STACK=[f.AXIS_LABEL,f.LEGEND_AXIS,f.AXIS_VALUE],this.DARW_STACK=[f.AXIS_VALUE,f.LEGEND_AXIS,f.AXIS_LABEL]}return r(e,[{key:"configure",value:function(e,t,o){this.colorRange=e,this.conf=t,this.childTextConf=o,this.compositionsByCategory={}}},{key:"getName",value:function(){return"LegendBody"}},{key:"getType",value:function(){return"legend"}},{key:"addCompositions",value:function(e,t){this.compositionsByCategory[t]=e}},{key:"getSpaceTaken",value:function(e){return"bottom"===this.conf.legendPosition?e.height:e.width}},{key:"getLogicalSpace",value:function(e,t,o){var r,n,a,i,l,s,c,u=this._lSpace,h=this.conf.padding,g=this.compositionsByCategory,p=0;if(u&&!o)return u.isImpure=!0,u;for(u=this._lSpace={bound:{height:0,width:0},node:{logicArea:d}},(i=w(e,{})).height-=2*h.v,i.width-=2*h.h,i.x+=h.h,i.y+=h.v,l=this.getCompositionPlotAreaFor(i),t.colorRange=this.colorRange,s=0,c=this.SC_STACK.length;s<c;s++)(r=g[this.SC_STACK[s]])&&(n=l(a,r.conf.spreadFactor),a=r.getLogicalSpace(w(n,{}),t,o),p+=this.getSpaceTaken(a));return this.updateEffectivePlotArea(e,i,p),u.node.logicArea=i,u.bound=e,e}},{key:"draw",value:function(){var e,t,o,r,n,a,i,l,s,c,u=this.childTextConf,d=this.conf.bound.style||{},h=this.compositionsByCategory;for(3<=arguments.length?(a=arguments[1],l=arguments[2]):2<=arguments.length&&(l=arguments[1]),t=l.parentLayer,e=l.animationManager,this.getLogicalSpace(a,l),i=this._lSpace,this.group=n=e.setAnimation({el:this.group||"group",attr:{name:"legend-body",transform:"t0,0"},css:u.style,container:t,component:p}),this.bound=o=e.setAnimation({el:this.bound||"rect",attr:i.bound,css:d,container:n,component:p}),l.colorRange=this.colorRange,l.parentLayer=n,s=0,c=this.DARW_STACK.length;s<c;s++)(r=h[this.DARW_STACK[s]])&&r.draw(l);return l.moveInstructions&&n.attr({transform:l.moveInstructions}),{bound:o,group:n}}},{key:"getCompositionPlotAreaFor",value:function(e){var t,o="bottom"===this.conf.legendPosition;return t=w(e,{}),function(r,n){return r=r||{},o?(t.y+=r.height||0,t.height=e.height*n):(t.x+=r.width||0,t.width=e.width*n),t}}},{key:"updateEffectivePlotArea",value:function(e,t,o){var r=this.conf.padding;"bottom"===this.conf.legendPosition?(t.height=o,e.height=o+2*r.v):(t.width=o,e.width=o+2*r.h)}}]),e}(),N=function(){function e(t){s(this,e),this.conf=t,this.node=[],this._id="GL_LABELS"}return r(e,[{key:"configure",value:function(e){this.conf=e}},{key:"getType",value:function(){return"label"}},{key:"getName",value:function(){return"LegendLabel"}},{key:"getEffectivePlotArea",value:function(e){var t=this.conf.padding;return e.height-=2*t.v,e.width-=2*t.h,e.x+=t.h,e.y+=t.v,e}},{key:"getLogicalSpace",value:function(e,t,o){var r,n,a,i,l,s,c,u,h,g,p,f,m,v,b,y,k,C,x,F,L,A,S,E=Math.max,O="bottom"===this.conf.legendPosition,P=this._lSpace,N=this.conf,I=N.padding,T=[],R=t.gLegend.getFromEnv("chartConfig"),M=[];if(P&&!o)return P.isImpure=!0,P;for(r=t.colorRange,n=t.smartLabel,g=r.getCumulativeValueRatio(),a=r.colorRange,m=(P=this._lSpace={bound:{height:0,width:0},node:{logicArea:d,smartTexts:[]}}).node.smartTexts,u=w(e,{}),b=this.getEffectivePlotArea(u),S=O?b.width:b.height,n.useEllipsesOnOverflow(R.useEllipsesWhenOverflow),A=w(N.style,{}),_(this._metaStyle=A),n.setStyle(A),y=n.getSmartText("W"),i=0,l=a.length;i<l;i++)(h=a[i].label)?M.push({oriIndex:i,label:h}):m[i]=d;if(0===(l=M.length))return{height:0,width:0};for(f=p=1<l?(g[M[l-1].oriIndex]-g[M[0].oriIndex])/2*S/100:E(g[M[0].oriIndex],100-g[M[0].oriIndex])/2*S/100,O?((F=n.getSmartText(M[0].label,f,b.height)).x=g[M[0].oriIndex]*b.width/100,s=F.x+F.width):((F=n.getSmartText(M[0].label,f,b.width)).y=g[M[0].oriIndex]*b.height/100,s=F.y+F.width),T.push(F.height),m[M[0].oriIndex]=F,O?((F=n.getSmartText(M[l-1].label,f,b.height)).x=g[M[l-1].oriIndex]*b.width/100,c=F.x-F.width):((F=n.getSmartText(M[l-1].label,f,b.width)).y=g[M[l-1].oriIndex]*b.height/100,c=F.y-F.width),T.push(F.height),m[M[l-1].oriIndex]=F,x=s,i=1;i<l-1;i++)h=M[i].label,L=M[i].oriIndex,F=d,k=i+1===l-1?c:g[M[i+1].oriIndex]*S/100,C=g[M[i].oriIndex]*S/100,(p=Math.min(C-x,k-C))>2*y.width&&(O?(F=n.getSmartText(h,p,b.height)).x=g[L]*b.width/100:(F=n.getSmartText(h,p,b.width)).y=g[L]*b.height/100,x=p,T.push(F.height)),m[M[i].oriIndex]=F;return v=E.apply(Math,T),O?(b.height=v,e.height=v+2*I.v):(b.width=v,e.width=v+2*I.v),P.node.logicArea=b,P.bound=e,e}},{key:"draw",value:function(){var e,t,o,r,n,a,i,l,s,c,u,d,h="bottom"===this.conf.legendPosition,g=this.conf,f=g.bound&&g.bound.style||{stroke:"none"},m={};2<=arguments.length&&arguments[1]?(r=arguments[0],i=arguments[1]):1<=arguments.length&&(i=arguments[0]),d=i.animationManager,e=i.parentLayer,this.getLogicalSpace(r,i),s=(a=this._lSpace).node.logicArea,c=a.node.smartTexts,this.group=o=d.setAnimation({el:this.group||"group",attr:{name:"legend-labels"},container:e,component:p}),this.bound=t=d.setAnimation({el:this.bound||"rect",attr:a.bound,css:f,container:o,component:p});for(var v=0;v<this.node.length;v++)this.node[v].remove();for(this.node=[],l=0,u=c.length;l<u;l++)(n=c[l])&&(h?(m.y=s.y+n.height/2,m.x=l===u-1?s.x+n.x-n.width/2:l?s.x+n.x:s.x+n.x+n.width/2):(m.x=s.x+n.height/2,m.y=l===u-1?s.y+n.y-n.width/2:l?s.y+n.y:s.y+n.y+n.width/2),this.node.push(d.setAnimation({el:"text",attr:{text:n.text,x:m.x,y:m.y,lineHeight:this._metaStyle.lineHeight,fill:g.style.fill,transform:h?"R0":"R270,"+m.x+","+m.y},container:o,component:p})));return{group:o,bound:t,node:this.node}}}]),e}(),I=function(){function e(t){s(this,e),this.conf=t,this._id="FL_AXIS",this.node=d,this.group=d,this.shadow=d,this.markerLine=d,this.compositionsByCategory={}}return r(e,[{key:"configure",value:function(e){this.conf=e}},{key:"getName",value:function(){return"LegendAxis"}},{key:"getType",value:function(){return"axis"}},{key:"addCompositions",value:function(e,t){this.compositionsByCategory[t]=e}},{key:"getLogicalSpace",value:function(){var e,t,o,r,n,a,i="bottom"===this.conf.legendPosition,l=arguments[0],s=arguments[2],c=this._lSpace,u=this.conf,h=u.padding,g=u.legendAxisHeight,p=this.compositionsByCategory,m=0;return c&&!s?(c.isImpure=!0,c):(c=this._lSpace={bound:{height:0,width:0},node:{logicArea:d}},(n=w(l,{})).height-=2*h.v,n.width-=2*h.h,n.x+=h.h,n.y+=h.v,e=g/2+u.line.offset,t=g/2,(r=p[f.RANGE])&&(a=r.sliders.false.conf.outerCircle.rFactor*g,t+=m=Math.max(a/2-g/2,0)),i?(n.y+=m,n.height=o=t+e+m,l.height=o+2*h.v):(n.x+=m,n.width=o=t+e+m,l.width=o+2*h.v),c.node.logicArea=n,c.bound=l,l)}},{key:"getDrawableAxisArea",value:function(e){var t=this.conf,o="bottom"===this.conf.legendPosition;return{x:e.x,y:e.y,width:o?e.width:t.legendAxisHeight,height:o?t.legendAxisHeight:e.height,r:t.legendAxisHeight/2}}},{key:"preDrawingRangeParamV",value:function(e){return{x:e.x+e.width/2,calculationBase:e.width,rangeStart:e.y,rangeEnd:e.y+e.height,prop:"x"}}},{key:"preDrawingRangeParamH",value:function(e){return{y:e.y+e.height/2,calculationBase:e.height,rangeStart:e.x,rangeEnd:e.x+e.width,prop:"y"}}},{key:"preDrawingRangeParam",value:function(e){return"bottom"===this.conf.legendPosition?this.preDrawingRangeParamH(e):this.preDrawingRangeParamV(e)}},{key:"getScaleMarkerPathStrH",value:function(e,t){var o,r,n,a,i,l=w(e,{}),s=this.conf.line,c="",u="";for(l.x+=l.r,l.width-=2*l.r,i=l.y+l.height,o=0,r=t.length;o<r;o++)n=t[o],a=l.x+n*l.width/100,c+=C+a+","+(i-s.grooveLength)+x+a+","+(i+s.offset);return c+(u+=C+l.x+","+(i+s.offset)+x+(l.x+l.width)+","+(i+s.offset))}},{key:"getColorGradientH",value:function(e){return{axis:e.getBoxFill(),shadow:(0,a.toRaphaelColor)({FCcolor:{alpha:"25,0,0",angle:90,color:"000000,FFFFFF,FFFFFF",ratio:"0,30,40"}})}}},{key:"draw",value:function(){var e,t,o,r,n,a,i,l,s,c,u,d,h,g,m=this.conf,v=m.bound||{},b=m.line,y=v.style||{},k=this.compositionsByCategory;for(o in 2<=arguments.length?(t=arguments[0],d=arguments[1]):1<=arguments.length&&(d=arguments[0]),h=d.animationManager,e=d.parentLayer,n=(r=d.colorRange).getCumulativeValueRatio(),this.getLogicalSpace(t,d),u=this._lSpace,this.group=i=h.setAnimation({el:this.group||"group",attr:{name:"legend-axis"},container:e,component:p}),this.bound=h.setAnimation({el:this.bound||"rect",attr:u.bound,css:y,component:p,container:i}),c=this.getDrawableAxisArea(u.node.logicArea),s=this.getColorGradient(r),m.style.fill=s.axis,m.shadow.style.fill=s.shadow,this.node=h.setAnimation({el:this.node||"rect",attr:c,css:m.style,container:i,component:p}),this.shadow=h.setAnimation({el:this.shadow||"rect",attr:c,css:m.shadow.style,container:i,component:p}),g=this.getScaleMarkerPathStr(c,n),this.path=h.setAnimation({el:this.path||"path",attr:{path:g},css:b.style,container:i,component:p}),k)a=k[o],o===f.RANGE&&(d[(l=this.preDrawingRangeParam(c)).prop]=l[l.prop],d.key=l.prop,d.rCalcBase=l.calculationBase,d.parentLayer=i,a.draw(l.rangeStart,l.rangeEnd,d))}},{key:"getScaleMarkerPathStr",value:function(e,t){return"bottom"===this.conf.legendPosition?this.getScaleMarkerPathStrH(e,t):this.getScaleMarkerPathStrV(e,t)}},{key:"getColorGradient",value:function(e){return"bottom"===this.conf.legendPosition?this.getColorGradientH(e):this.getColorGradientV(e)}},{key:"getScaleMarkerPathStrV",value:function(e,t){var o,r,n,a,i,l=w(e,{}),s=this.conf.line,c="",u="";for(l.y+=l.r,l.height-=2*l.r,a=l.x+l.width,o=0,n=t.length;o<n;o++)r=t[o],i=l.y+r*l.height/100,c+=C+(a-s.grooveLength)+","+i+x+(a+s.offset)+","+i;return c+(u+=C+(a+s.offset)+","+l.y+x+(a+s.offset)+","+(l.y+l.height))}},{key:"getColorGradientV",value:function(e){return{axis:e.getBoxFill(!0),shadow:(0,a.toRaphaelColor)({FCcolor:{alpha:"25,0,0",angle:360,color:"000000,FFFFFF,FFFFFF",ratio:"0,30,40"}})}}}]),e}(),T=function(){function e(t,o,r){s(this,e),this.conf=o.conf,this.sliderIndex=t,this.rangeGroup=o.sliderGroup,this._id=r,this.node=d,this.tracker=d,this.currPos=0,this.swing=[]}return r(e,[{key:"configure",value:function(e,t,o){this.conf=t.conf,this.sliderIndex=e,this.rangeGroup=t.sliderGroup,this._id=o,this.currPos=0,this.swing=[]}},{key:"getType",value:function(){return"slider"}},{key:"getName",value:function(){return"Slider"}},{key:"updateSwingRange",value:function(e,t){this.swing[+e]=t}},{key:"draw",value:function(e,t,o,r){var n,a,i,l,s,c,u=Math.ceil,d=r.parentLayer,h=r.animationManager,f=this.conf,v=f.outerCircle,b=f.innerCircle,y=u(v.rFactor*r.rCalcBase/2),k=u(b.rFactor*r.rCalcBase/2),C=y-k,x=this.sliderIndex;return f.outerRadius=y,f.innerRadius=k,this._scaleVal=t,b.style["stroke-width"]=C,k+=i=u(v.style["stroke-width"]/2),n=this.node=h.setAnimation({el:this.node||"group",attr:{name:"fc-gl-slider",cursor:"pointer",transform:"t0,0"},container:d,component:p}),"x"===r.key?(l=o,s=e,s+=x?-k:+k):(l=e,s=o,l+=x?-k:+k),this.oCircle=h.setAnimation({el:this.oCircle||"circle",attr:{cx:l,cy:s,r:y},css:v.style,container:n,component:p}),this.iCircle=h.setAnimation({el:this.iCircle||"circle",attr:{cx:l,cy:s,r:k},css:b.style,container:n,component:p}),c=this.tracker=h.setAnimation({el:this.tracker||"circle",attr:{cx:l,cy:s,r:y+5,fill:m,stroke:m,cursor:"pointer"},container:n,component:p}),n.attr({transform:"x"===r.key?"t0,"+this.currPos:"t"+this.currPos+",0"}),g.enableToolTip(c,t),this._dragAPI=a=this.getDragAPI("x"===r.key),c.undrag(),c.drag(a.dragging,a.dragStart,a.dragEnd),{translateAscending:y+i}}},{key:"getDragAPI",value:function(e){var t,o,r,n,a=this,i=a.node,l=a.sliderIndex,s=a.rangeGroup,c=a.conf.innerRadius;return{dragging:function(u){var d,h,g,p,f;return u.stopPropagation(),u.preventDefault(),g=e?u.data[1]:u.data[0],l?(d=t[0]-t[1]+c,h=0):(d=0,h=t[1]-t[0]-c),(f=a.currPos+g)<d?g+=d-f:f>h&&(g-=f-h),i.attr({transform:e?"t0,"+(a.currPos+g):"t"+(a.currPos+g)+",0"}),o=g,r&&clearTimeout(r),r=setTimeout(function(){s.updateWhenInRest(a,a.currPos+g)},100),p=s.updateWhenInMove(a,a.currPos+g),a.tracker.data("__FC_tooltipText",p),n=!0,!0},dragStart:function(e){e.stopPropagation(),e.preventDefault(),t=a.swing,n=!1,s.dragStarted(a)},dragEnd:function(){var e;s.dragCompleted(a,n,a.currPos+o),n&&(r&&clearTimeout(r),r=setTimeout(function(){s.updateWhenInRest(a,a.currPos)},100),a.currPos+=o,e=t[+l]+a.currPos,s.updateRange(a,e))}}}},{key:"dispose",value:function(){this.node.remove(),this.oCircle.remove(),this.iCircle.remove(),this.tracker.remove()}}]),e}(),R=function(){function e(t){s(this,e);var o={};this._id="GL_SG1",this.conf=t,o.conf=t,this.extremes=[],this.sliders={},this.min=void 0,this.max=void 0,o.sliderGroup=this,this.valueRange=[],this.callbacks=[],this.sliders[v]=new T(v,o,this._id+"_0"),this.sliders[b]=new T(b,o,this._id+"_1")}return r(e,[{key:"configure",value:function(e){var t={};this.min=void 0,this.max=void 0,this.conf=e,t.conf=e,t.sliderGroup=this,this.sliders[v].configure(v,t,this._id+"_0"),this.sliders[b].configure(b,t,this._id+"_1")}},{key:"getType",value:function(){return"slider"}},{key:"getName",value:function(){return"SliderGroup"}},{key:"initRange",value:function(e,t){var o=e.sliderIndex;this.extremes[+o]=t}},{key:"updateRange",value:function(e,t){var o=e.sliderIndex;this.sliders[!o].updateSwingRange(o,t)}},{key:"reset",value:function(){var e={};e.conf=this.conf,e.sliderGroup=this,this.min=void 0,this.max=void 0,this.sliders[v].configure(v,e,this._id+"_0"),this.sliders[b].configure(b,e,this._id+"_1"),this.draw.apply(this,this._drawParams)}},{key:"draw",value:function(e,t,o){var r,n,a,i,l,s=Math.ceil,c=this.sliders,u=c[!1],d=c[!0],h=o.colorRange,g=h.colorRange,p=h.data.mapByPercent,f=o.gLegend.getFromEnv("number-formatter");return this._fcChart=o.gLegend.getFromEnv("chart"),this.getValueFormPixel=function(e,t,o,r){this.getValueFormPixel=function(n){return e+(t-e)/(r-o)*n}},this.updateWhenInMove=function(e,t){this.updateWhenInMove=function(o,r){var n,a,i=this.extremes;return n=o.sliderIndex?i[1]-i[0]+r:r,a=this.getValueFormPixel(n),a=t?parseFloat(a).toFixed(2)+"%":e.legendValue(a)}},this._drawParams=[e,t,o],this.updateWhenInMove(f,p),n=u.conf.outerCircle,a=s(u.conf.innerCircle.rFactor*o.rCalcBase/2),a+=s(n.style["stroke-width"]/2),this.extremes[0]=e+a,this.extremes[1]=t-a,i=this.extremes[1]-this.extremes[0],this.min=this.min?this.min:g[0].value,this.max=this.max?this.max:g[g.length-1].value,l=g[g.length-1].value-g[0].value,u.currPos=i*(this.min-g[0].value)/l,d.currPos=i*(this.max-g[0].value)/l-i,u.draw(e,p?f.legendPercentValue(this.min):f.legendValue(this.min),o[o.key],o),r=d.draw(t,p?f.legendPercentValue(this.max):f.legendValue(this.max),o[o.key],o),u.swing=this.extremes.slice(0),d.swing=this.extremes.slice(0),u.swing[1]+=d.currPos,d.swing[0]+=u.currPos,this.getValueFormPixel(g[0].value,g[g.length-1].value,this.extremes[0],this.extremes[1]),r}},{key:"updateWhenInRest",value:function(e,t){var o,r,n=this.sliders,a=this.extremes,i=e.sliderIndex;i?(o=n[!i].currPos,r=a[1]-a[0]+t):(o=t,r=a[1]-a[0]+n[!i].currPos),this.min=+this.getValueFormPixel(o).toFixed(2),this.max=+this.getValueFormPixel(r).toFixed(2),this.gLegend.fireEvent("rangeUpdated",[{min:this.min,max:this.max}])}},{key:"dragStarted",value:function(e){var t=this.sliders,o=this.extremes,r=e.conf,n=this._fcChart;n.fireChartInstanceEvent("legendpointerdragstart",{pointerIndex:+e.sliderIndex,pointers:[{value:this.getValueFormPixel(t.false.currPos)},{value:this.getValueFormPixel(o[1]-o[0]+t.true.currPos)}],legendPointerHeight:r.outerRadius,legendPointerWidth:r.innerRadius,outerRadius:r.outerRadius,innerRadius:r.innerRadius},[n.id])}},{key:"dragCompleted",value:function(e,t,o){var r,n,a=this.sliders,i=this.extremes,l=e.conf,s=this.getValueFormPixel(a.false.currPos),c=this.getValueFormPixel(i[1]-i[0]+a.true.currPos),u=this._fcChart;e.sliderIndex?(r=s,n=this.getValueFormPixel(i[1]-i[0]+o)):(r=this.getValueFormPixel(o),n=c),t&&u.fireChartInstanceEvent("legendrangeupdated",{previousMinValue:s,previousMaxValue:c,minValue:r,maxValue:n},[u.id]),u.fireChartInstanceEvent("legendpointerdragstop",{pointerIndex:+e.sliderIndex,pointers:[{value:r},{value:n}],legendPointerHeight:l.outerRadius,legendPointerWidth:l.innerRadius,outerRadius:l.outerRadius,innerRadius:l.innerRadius},[u.id])}},{key:"dispose",value:function(){this.sliders[v].dispose(),this.sliders[b].dispose()}}]),e}(),M=function(e){function t(){var e;return s(this,t),(e=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,arguments[0])))._id="GL_VALUES",e.node=[],e}return u(t,N),r(t,[{key:"configure",value:function(e){this.conf=e}},{key:"getName",value:function(){return"LegendValues"}},{key:"getType",value:function(){return"legend"}},{key:"getLogicalSpace",value:function(e,t,o){var r,n,a,i,l,s,c,u,h,g,p,f,m,v,b,y,k,C,x,F,L,A,S,E,O,P=Math.min,N=Math.max,I="bottom"===this.conf.legendPosition,T=this._lSpace,R=this.conf,M=R.padding,j=t.gLegend.getFromEnv("chartConfig"),B=[],D=[];if(T&&!o)return T.isImpure=!0,T;for(r=t.colorRange,n=t.smartLabel,a=r.colorRange,c=r.getCumulativeValueRatio(),O=(T=this._lSpace={bound:{height:0,width:0},node:{logicArea:d,smartTexts:[]}}).node.smartTexts,(F=w(e,{})).height-=2*M.v,F.width-=2*M.h,F.x+=M.h,F.y+=M.v,n.useEllipsesOnOverflow(j.useEllipsesWhenOverflow),E=w(R.style,{}),_(this._metaStyle=E),n.setStyle(E),S=n.getSmartText("W"),s=a.length,I?(p=u=(c[s-1]-c[0])/2*F.width/100,A=a[0].displayValue,(i=n.getSmartText("string"!=typeof A&&A!==d&&A.toString()||A,p,F.height)).x=c[0]*F.width/100,f=i.x+i.width,B.push(i.height)):(p=u=(c[s-1]-c[0])/2*F.height/100,(i=n.getSmartText(a[0].displayValue,F.width,p)).y=c[0]*F.height/100,b=i.y+i.width,D.push(i.width)),O[0]=i,I?((i=n.getSmartText(a[s-1].displayValue,p,F.height)).x=c[s-1]*F.width/100,v=i.x-i.width,B.push(i.height),m=f):((i=n.getSmartText(a[s-1].displayValue,F.width,p)).y=c[s-1]*F.height/100,k=i.y-i.height,D.push(i.width),y=b),O[s-1]=i,l=1;l<s-1;l++)i=d,L=a[l].displayValue,I?(h=l+1===s-1?v:c[l+1]*F.width/100,(u=P((g=c[l]*F.width/100)-m,h-g))>1.5*S.width&&((i=n.getSmartText(L,2*u,F.height)).x=c[l]*F.width/100,m=u,B.push(i.height))):(h=l+1===s-1?k:c[l+1]*F.height/100,(u=P((g=c[l]*F.height/100)-y,h-g))>2*S.height&&((i=n.getSmartText(L,F.width,2*u)).y=c[l]*F.height/100,y=u,D.push(i.width))),O[l]=i;return I?(C=N.apply(Math,B),F.height=C,e.height=C+2*M.v):(x=N.apply(Math,D),F.width=x,e.width=x+2*M.h),T.node.logicArea=F,T.bound=e,e}},{key:"draw",value:function(){var e,t,o,r,n,a,i,l,s,c,u,d,h,g=this.conf,f="bottom"===g.legendPosition,m=g.bound&&g.bound.style||{stroke:"none"},v={};2<=arguments.length&&arguments[1]?(r=arguments[0],i=arguments[1]):1<=arguments.length&&(i=arguments[0]),h=i.animationManager,e=i.parentLayer,l=i.colorRange.getCumulativeValueRatio(),this.getLogicalSpace(r,i),a=(n=this._lSpace).node.logicArea,u=n.node.smartTexts,this.group=o=h.setAnimation({el:this.group||"group",attr:{name:"legend-values"},container:e,component:p}),this.bound=t=h.setAnimation({el:this.bound||"rect",attr:n.bound,css:m,container:o,component:p});for(var b=0;b<this.node.length;b++)this.node[b].remove();for(this.node=[],s=0,c=l.length;s<c;s++)(d=u[s])&&(f?(v.y=a.y+d.height/2,v.x=s===c-1?a.x+d.x-d.width/2:s?a.x+d.x:a.x+d.x+d.width/2):(v.x=a.x+d.width/2,v.y=s===c-1?a.y+d.y-d.height/2:s?a.y+d.y:a.y+d.y+d.height/2),this.node.push(h.setAnimation({el:"text",attr:{text:d.text,x:v.x,y:v.y,lineHeight:this._metaStyle.lineHeight,fill:g.style.fill},container:o,component:p})));return{group:o,bound:t}}}]),t}();t.default=A}}]);